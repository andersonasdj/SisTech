<!DOCTYPE html>
<html lang="pt-BR">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" href="../assets/img/favicon.ico">
	<link rel="stylesheet" href="../assets/css/styleBusca.css">
	<link rel="stylesheet" href="../assets/css/StyleClientesFuncionarios.css">
	<link rel="stylesheet" href="../assets/css/bootstrap.min.css">
	<link rel="stylesheet" href="../assets/css/password-generator.css">
	<link rel="stylesheet" href="../assets/css/bootstrap-icons.min.css">
	<link rel="stylesheet" href="../assets/css/computadores.css">
	<link rel="stylesheet" href="../assets/css/dark.css">
	<title>Sistech - Computadores</title>
</head>
<body>
	<div class="container-fluid">
		<!-- ###################################### BARRA DE NAVEGAÇÃO ###################################### -->
		<nav class="navbar navbar-expand-lg bg-light">
			<div class="container-fluid">
				<a class="navbar-brand" href="/sistech/home"><img src="../assets/img/key.png" style="height: 18px;"> SisTech</a>
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse"
					data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
					aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarSupportedContent">
					<ul class="navbar-nav me-auto mb-2 mb-lg-0">
						<li class="nav-item"><a class="nav-link active" aria-current="page" href="/sistech/home">Início</a></li>
							<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Solicitações</a>
							<ul class="dropdown-menu">
								<li><a class="dropdown-item" href="/sistech/solicitacao/form">Novo</a></li>
								<li><a class="dropdown-item" href="/sistech/solicitacao/list">Listar</a></li>
								<li><hr class="dropdown-divider"></li>
								<li><a class="dropdown-item" href="/sistech/solicitacao/modelos">Modelos</a></li>	
								<li><hr class="dropdown-divider"></li>
								<li><a class="dropdown-item" href="/sistech/solicitacao/relatorios">Relatórios</a></li>
							</ul>
						</li>
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Clientes</a>
							<ul class="dropdown-menu">
								<li><a class="dropdown-item" href="/sistech/cliente/list">Listar</a></li>
								<li><a class="dropdown-item" href="/sistech/cliente/form">Novo</a></li>
							</ul>
						</li>
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Funcionarios</a>
							<ul class="dropdown-menu">
								<li><a class="dropdown-item" href="/sistech/funcionario/list">Listar</a></li>
								<li><a class="dropdown-item" href="/sistech/funcionario/form">Novo</a></li>
							</ul>
						</li>
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Dashboard</a>
							<ul class="dropdown-menu">
								<li><a class="dropdown-item" href="/dashboard/inicio" target="_blank" style="color: brown; font-weight: bold;">Realtime <i class="bi bi-speedometer2"></i></a></li>
								<li><a class="dropdown-item" href="/sistech/solicitacao/dashboard/geral">Solicitações ativas</a></li>
								<li><a class="dropdown-item" href="/sistech/solicitacao/dashboard/funcionario">Funcionario</a></li>
								<li><a class="dropdown-item" href="/sistech/solicitacao/dashboard/cliente">Cliente</a></li>
							</ul>
						</li>
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Ferramentas</a>
							<ul class="dropdown-menu">
								<li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#modalPasswordGenerator">Password Generator</a></li>
								<li><a class="dropdown-item" href="/sistech/avisos">Avisos</a></li>
								<li><a class="dropdown-item" href="/sistech/calendario">Calendário</a></li>
							</ul>
						</li>
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle color-text" href="#" role="button" data-bs-toggle="dropdown"aria-expanded="false">Computadores</a>
							<ul class="dropdown-menu">
								<li><a class="dropdown-item" href="/sistech/computador/list">Listar</a></li>
							</ul>
						</li>
					</ul>
					<span class="nav-item">
						  <button class="btn btn-sm btn-outline-secondary" onclick="toggleDarkMode()" id="toggleDarkBtn">
						    <i class="bi bi-moon"></i> Modo Escuro
						  </button>
						</span>
						&nbsp; &nbsp; &nbsp; &nbsp;
					<ul class="navbar-nav mb-3 mb-lg-0">
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" id="perfil" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"></a>
							<ul class="dropdown-menu">
								<li><a class="dropdown-item" href="/sistech/funcionario/perfil">Perfil</a></li>
								<li><hr class="dropdown-divider"></li>
								<li><a class="dropdown-item" href="/sistech/gerencia">Gerência</a></li>
								<li><a class="dropdown-item" href="/sistech/configuracoes">Configurações</a></li><li>
								<li><hr class="dropdown-divider"></li>
								<li><a class="dropdown-item" href="/sistech/sobre">Sobre</a></li>
							</ul>
						</li>
							<a href="/sistech/logout"><i class="bi bi-power"style="font-size: 2rem; color: red;"></i></a>
					</ul>
				</div>
			</div>
		</nav>
		<!-- ###################################### BARRA DE NAVEGAÇÃO ###################################### -->

		<hr class="bg-danger border-2 border-top border-danger">
		
		<div class="container-fluid">
			
			<div class="row justify-content-between">
				<div class="col-4 col-s-12">
					<div class="control-group">
						<div class="controls">
							<select class="form-select" id="idCliente" name="idCliente" style="width: 250px;"> </select>
						</div>
					</div>
				</div>
				<div class="col-2 col-s-12 mt-2">
					<h4><span class="spamTotal" id="totalSolicitacoes"> </span></h4>
				</div>
				
				<div class="col-4 col-s-12">
					<a href="#" onclick="listarComputadores()" class="btn"><i class="bi bi-arrow-clockwise"> </i></a>
					<button class="btn">Total <span id="qtdComputadores"> </span></button>
				</div>
			</div>
			<hr class="bg-danger border-2 border-top border-danger">
			
		  <div class="row">
		    <div class="col">
				<button class="btn btn-primary" onclick="alternarVisualizacao()" id="btnToggleView">
				  Visualizar como Cards
				</button>

		    </div>
		    <div class="col">
				<div class="form-group pull-right">
		    		<input id="boxBusca" type="text" class="search form-control" placeholder="Busca" autocomplete="off">
				</div>
				<span class="counter pull-right"> </span>
		    </div>
		  </div>
		</div>
		<div class="table-responsive">
			<div id="visualizacao-tabela" class="table-responsive">

				<table class="table table-striped align-middle results" id="tabela-computadores">
					<thead>
						<tr>
							<th scope="col">Status</th>
							<th></th>
							<th scope="col">Cliente</th>
							<th scope="col">Comentário</th>
							<th scope="col">Hostname</th>
							<th scope="col">Usuário</th>
							<th scope="col">SO</th>
							<th scope="col">CPU</th>
							<th scope="col">Memória</th>
							<th scope="col">Fabricante</th>
							<th scope="col">Serial</th>
							<th scope="col">Ultima Autalização</th>
							<th></th>
						</tr>
					</thead>
					<tbody id="corpoComputadores">
						<tr> </tr>
					</tbody>
				</table>
			</div>
		</div>
		<div id="visualizacao-cards" class="row d-none"></div>
		<br /><br />
		<footer class="container-fluid fixed-bottom text-center text-white">
				<div class="text-center" style="background-color: rgba(0, 0, 0, 0.2);">
					© 2025 Copyright:
					<a class="text-white" href="#">TechGold</a>
				</div>
		</footer>
		
		<div id="detalheComputador" class="offcanvas offcanvas-bottom shadow rounded-top" tabindex="-1" style="height: 90vh; max-height: 90vh; overflow-y: auto;">
		  <div class="offcanvas-header bg-secondary text-white">
		    <h5 id="detalheComputadorLabel">
		      <i class="bi bi-pc-display"></i> Detalhes do Computador
		    </h5>
		    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
		  </div>
		  <div class="offcanvas-body bg-light" id="detalheComputadorConteudo">
		    <div class="container">
		      <div class="row g-3">
		        <div class="col-md-6">
		          <h6 class="text-primary border-bottom pb-1 mb-2">Informações Gerais</h6>
		          <ul class="list-group list-group-flush small">
		            <li class="list-group-item"><strong>Comentário:</strong> <span id="detalhe-comentario"></span></li>
		            <li class="list-group-item"><strong>Hostname:</strong> <span id="detalhe-hostname"></span></li>
		            <li class="list-group-item"><strong>Domínio:</strong> <span id="detalhe-dominio"></span></li>
		            <li class="list-group-item"><strong>Usuário:</strong> <span id="detalhe-usuario"></span></li>
		            <li class="list-group-item"><strong>Plataforma:</strong> <span id="detalhe-plataforma"></span></li>
		            <li class="list-group-item"><strong>OS:</strong> <span id="detalhe-os"></span></li>
		            <li class="list-group-item"><strong>Arquitetura:</strong> <span id="detalhe-arquitetura"></span></li>
		          </ul>

		          <h6 class="text-primary border-bottom pb-1 mt-4 mb-2">Memória & Processador</h6>
		          <ul class="list-group list-group-flush small">
		            <li class="list-group-item"><strong>CPU:</strong> <span id="detalhe-cpu"></span></li>
		            <li class="list-group-item"><strong>Memória:</strong> <span id="detalhe-memoria"></span></li>
		            <li class="list-group-item"><strong>Slots de Memória:</strong> <span id="detalhe-slotsmemoria"></span></li>
		          </ul>
				  
				  <h6 class="text-primary border-bottom pb-1 mt-4 mb-2">Rede <span id="velocidade-rede"></span></h6>
		          <ul class="list-group list-group-flush small">
		            <li class="list-group-item"><strong>IP:</strong> <span id="detalhe-ip"></span></li>
		            <li class="list-group-item"><strong>Gateway:</strong> <span id="detalhe-gateway"></span></li>
		            <li class="list-group-item"><strong>DNS:</strong> <span id="detalhe-dns"></span></li>
		            <li class="list-group-item"><strong>MAC:</strong> <span id="detalhe-mac"></span></li>
		          </ul>
		        </div>

		        <div class="col-md-6">
		          <h6 class="text-primary border-bottom pb-1 mb-2">Armazenamento & Segurança</h6>
		          <ul class="list-group list-group-flush small">
		            <li class="list-group-item"><strong>Armazenamento:</strong> <span id="detalhe-disco"></span></li>
					<li class="list-group-item"><strong>Disponível:</strong> <span id="detalhe-discodisponivel"></span></li>
		            <li class="list-group-item"><strong>Tipo:</strong> <span id="detalhe-tipo"></span></li>
		            <li class="list-group-item"><strong>Antivirus:</strong> <span id="detalhe-antivirus"></span></li>
		            <li class="list-group-item"><strong>Bitlocker:</strong> <span id="detalhe-bitlocker"></span></li>
		          </ul>

		          <h6 class="text-primary border-bottom pb-1 mt-4 mb-2">Outros</h6>
		          <ul class="list-group list-group-flush small">
					<li class="list-group-item"><strong>Modelo:</strong> <span id="detalhe-modelo"></span></li>
		            <li class="list-group-item"><strong>Serial:</strong> <span id="detalhe-serial"></span></li>
		            <li class="list-group-item"><strong>Fabricante:</strong> <span id="detalhe-fabricante"></span></li>
		            <li class="list-group-item"><strong>Bios Release:</strong> <span id="detalhe-biosrelease"></span></li>
		            <li class="list-group-item"><strong>Timezone:</strong> <span id="detalhe-timezone"></span></li>
					<li class="list-group-item"><strong>GPU:</strong> <span id="detalhe-gpu"></span></li>
		            <li class="list-group-item"><strong>Última Atualização:</strong> <span id="detalhe-atualizacao"></span></li>
		            <li class="list-group-item"><strong>Último Boot:</strong> <span id="detalhe-ultimoboot"></span></li>
		            <li class="list-group-item"><strong>Instalação Agente:</strong> <span id="detalhe-instalacaoagente"></span></li>
		          </ul>
		        </div>

		      </div>
		    </div>
		  </div>
		</div>
		<!-- ##########################################  MODAL EDIÇÃO ############################################### -->
		<div class="modal fade" id="modalEdicao" tabindex="-1" aria-labelledby="modalEdicaoLabel" aria-hidden="true">
			<div class="modal-dialog modal-lg modal-dialog-centered">
				<div class="modal-content shadow-lg border-0 rounded-3">
					<div class="modal-header">
						<h5 class="modal-title" id="modalEdicaoLabel">
							🛠️ Edição do Computador — ID: <span id="idmodal" class="fw-bold"></span>
						</h5>
						<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
					</div>

					<div class="modal-body">
						<span id="id_cliente" style="display: none;"></span>

						<div class="row g-3">
							<div class="col-md-6">
								<div class="form-floating">
									<input type="text" id="comentario-modal" class="form-control" placeholder="Comentário">
									<label for="comentario-modal"><b>Comentário</b></label>
								</div>
							</div>

							<div class="col-md-6 d-flex flex-column justify-content-center">
								<div class="form-check form-switch mb-2">
									<input class="form-check-input" type="checkbox" id="storageMonitor">
									<label class="form-check-label" for="storageMonitor">
										Ativar Monitoramento de Armazenamento
									</label>
								</div>

								<div class="form-check form-switch">
									<input class="form-check-input" type="checkbox" id="statusMonitor">
									<label class="form-check-label" for="statusMonitor">
										Ativar Monitoramento de Status
									</label>
								</div>
							</div>
						</div>
					</div>
					
					<div class="modal-footer bg-light">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal" title="Fechar o quadro de edição">
							<i class="bi bi-x-circle"></i> Fechar
						</button>
						<button type="button" class="btn btn-success" onclick="atualizaComputador()" title="Salvar a solicitação">
							<i class="bi bi-save2"></i> Salvar
						</button>
					</div>
				</div>
			</div>
		</div>
		<!-- #################################  MODAL EDIÇÃO ######################################################## -->
		
	<script src="../assets/js/jquery-3.6.3.js"></script>
	<script src="../assets/js/popper.min.js"></script>
	<script src="../assets/js/bootstrap.min.js"></script>
	<script src="../assets/js/dark.js"></script>
	<script>
		document.addEventListener("DOMContentLoaded", function () {
			const tooltipTriggerList = [].slice.call(document.querySelectorAll('[title]'));
			tooltipTriggerList.forEach(function (el) {
				new bootstrap.Tooltip(el);
			});
		});
		
		$(document).ready(function () {
			$.ajax({
			type: "GET",
			contentType: "application/json",
			url: "/sistech/solicitacao/getData",
				success: function (data) {
					for (var i = 0; i < data.clientes.length; i++) {
						$('#idCliente').append('<option value="' + data.clientesId[i] + '">' + data.clientes[i] + '</option>');
					}
					listarComputadores();
				},
				statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); }
				}
			});
			
			var divCliente = $("#idCliente");
			divCliente.on("change", function () {
				listarComputadores();
			});
		});
	</script>
	<script>
		function mostrarDetalhes(id) {
		  $.ajax({
		    type: "GET",
		    url: "/sistech/api/v1/computador/completo/" + id,
		    success: function (data) {
				
				$("#velocidade-rede").text(" ");
				$("#velocidade-rede").text(' ('+ data.networkSpeedMbps +' Mbps) ');
				
				$("#detalhe-comentario").text(data.comment);
		      	$("#detalhe-hostname").text(data.name);
		      	$("#detalhe-dominio").text(data.domain);
		      	$("#detalhe-usuario").text(data.username);
				$("#detalhe-plataforma").text(data.platform);
				$("#detalhe-os").text(data.os);
				$("#detalhe-arquitetura").text(data.osArchitecture);
		      	$("#detalhe-cpu").text(data.cpu);
		      	$("#detalhe-memoria").text(`${data.ram} (Disponível: ${data.ramAvailable})`);
				$("#detalhe-slotsmemoria").text(data.memorySlots ? data.memorySlots.join(", ") : "");
				$("#detalhe-serial").text(data.serial);
				$("#detalhe-timezone").text(data.timeZone);
				
		      	$("#detalhe-disco").text(data.disk ? data.disk.join(", ") : "");
				$("#detalhe-discodisponivel").text(data.diskAvailable ? data.diskAvailable.join(", ") : "");
		      	$("#detalhe-ip").text(data.ipAddresses ? data.ipAddresses.join(", ") : "");
				$("#detalhe-dns").text(data.dnsServers ? data.dnsServers.join(", ") : "");
				$("#detalhe-gateway").text(data.gateway);
		      	$("#detalhe-mac").text(data.mac);
				$("#detalhe-fabricante").text(data.manufacturer);
				$("#detalhe-tipo").text(data.deviceType);
				$("#detalhe-antivirus").text(data.antivirus);
				$("#detalhe-bitlocker").text(data.bitlockerRecoveryKeys ? data.bitlockerRecoveryKeys.join(", ") : "");
				$("#detalhe-biosrelease").text(data.biosReleaseDate);
				$("#detalhe-instalacaoagente").text(data.agent_install_date);
				$("#detalhe-ultimoboot").text(data.last_boot_time);
		      	$("#detalhe-atualizacao").text(data.last_seen);
				$("#detalhe-gpu").text(data.gpus ? data.gpus.join(", ") : "");
				$("#detalhe-modelo").text(data.device_name);
				

		      // abre a offcanvas
		      let canvas = new bootstrap.Offcanvas(document.getElementById('detalheComputador'));
		      canvas.show();
		    },
		    error: function () { alert("Erro ao carregar detalhes"); }
		  });
		}

		function atualizaComputador() {
			var id = $('#idmodal').text();
			var comment = $('#comentario-modal').val();
			var storageMonitor = $('#storageMonitor').prop("checked");
			var statusMonitor = $('#statusMonitor').prop("checked");

			$.ajax({
				type: "PUT",
				contentType: "application/json",
				url: "/sistech/api/v1/computador",
				data: JSON.stringify({
					"id": id,
					"comment": comment,
					"storageMonitor": storageMonitor,
					"statusMonitor": statusMonitor
				}),
				success: function (data) {
					alert(data);
					listarComputadores();
				},
				error: function (e) {
					alert("Você não tem permissão !");
				}
			});
		}

		
		function alternarVisualizacao() {
		  const tabela = document.getElementById('visualizacao-tabela');
		  const cards = document.getElementById('visualizacao-cards');
		  const botao = document.getElementById('btnToggleView');

		  if (tabela.classList.contains('d-none')) {
		    tabela.classList.remove('d-none');
		    cards.classList.add('d-none');
		    botao.innerText = 'Visualizar como Cards';
		  } else {
		    tabela.classList.add('d-none');
		    cards.classList.remove('d-none');
		    botao.innerText = 'Visualizar como Tabela';
		  }
		}

	</script>

	<script>
		function editar(id){
			$.ajax({
				type: "GET",
				contentType: "application/json",
				url: "/sistech/api/v1/computador/"+id,
				success: function (data) {
					$('#idmodal').text("");
					$('#idmodal').text(data.id);
					$('#comentario-modal').val("");
					$('#comentario-modal').val(data.comment);
					
					// Preenche os checkboxes com base nos valores booleanos
					$('#storageMonitor').prop("checked", data.storageMonitor === true);
					$('#statusMonitor').prop("checked", data.statusMonitor === true);
				},
				statusCode: {
				  	500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); }
				}
			});
					
		}
		
		function listarComputadores(){
			var idCliente = $("#idCliente").val();
			
			if(idCliente > 0){
				$.ajax({
					type: "GET",
					contentType: "application/json",
					url: "/sistech/api/v1/computador/cliente/"+idCliente,
					success: function (data) {
						
						$('#qtdComputadores').text("");
						$('#qtdComputadores').text(data.length);
						$('#corpoComputadores').empty();
						$('#visualizacao-cards').empty();
						
						data.forEach(i => {
							const dateString = i.last_seen;
							const [datePart, timePart] = dateString.split(' ');
							const [day, month, year] = datePart.split('/');
							const isoString = `${year}-${month}-${day}T${timePart}`;
							
							const lastSeenDate = new Date(isoString);
							const now = new Date();
							const diffMinutes = (now - lastSeenDate) / 1000 / 60;
							const isOnline = diffMinutes <= 5;
							const statusHTML = `<span class="badge rounded-pill ${isOnline ? 'bg-success' : 'bg-danger'}">
							  ${isOnline ? '<i class="bi bi-check-circle-fill"></i> Online' : '<i class="bi bi-x-circle-fill"></i> Offline'}
							</span>`;
							
							let deviceIcon = '';
							if (i.deviceType === 'Notebook') {
							    deviceIcon = '<i class="bi bi-laptop fs-3" title="Notebook"></i> ';
							} else if (i.deviceType === 'Desktop') {
							    deviceIcon = '<i class="bi bi-pc fs-3" title="Desktop"></i> ';
							} else if (i.deviceType === 'Servidor') {
							    deviceIcon = '<i class="bi bi-server fs-3" title="Servidor"></i> ';
							} else if (i.deviceType === 'All-in-One') {
							    deviceIcon = '<i class="bi bi-pc-display-horizontal fs-3" title="All-in-One"></i> ';
							}
							
							if (i.statusMonitor === true) {
							    deviceIcon += '<i class="bi bi-activity fs-4 text-success" title="Monitoramento Ativo"></i> ';
							}
							
							'<tr '+ status + ' id=linha' + i.id + ' data-bs-toggle="modal" data-bs-target="#modalEdicao" onclick=editar(' + i.id + ')>'
						      // Tabela
						      var itens = `<tr id="linha${i.id}">
								<td>${statusHTML}</td>
								<td>${deviceIcon}</td>
						        <td class="long-text" title="${i.cliente}">${i.cliente}</td>
								<td class="long-text" title="${i.comment}" data-bs-toggle="modal" data-bs-target="#modalEdicao" onclick=editar(${i.id})>${i.comment != null ? i.comment: ' '}</td>
						        <td class="long-text" title="${i.name}">${i.name}</td>
						        <td class="long-text" title="${i.username}">${i.username}</td>
						        <td class="long-text" title="${i.os}">${i.os}</td>
						        <td title="${i.cpu}">${i.cpu}</td>
						        <td class="long-text" title="${i.ram}">Instalada: ${i.ram}<p>Disponível: ${i.ramAvailable}</td>
								<td class="long-text" title="${i.manufacturer}">${i.manufacturer}</td>
								<td class="long-text" title="${i.serial}">${i.serial}</td>
						        <td class="long-text" title="${i.last_seen}">${i.last_seen}</td>
								<td class="long-text text-center">
								  <div class="btn-group btn-group-sm" role="group">
								    <button class="btn btn-outline-primary" title="Visualizar detalhes" onclick="mostrarDetalhes(${i.id})">
								      <i class="bi bi-eye"></i>
								    </button>
								    <button class="btn btn-outline-secondary" title="Editar comentário" data-bs-toggle="modal" data-bs-target="#modalEdicao" onclick="editar(${i.id})">
								      <i class="bi bi-pencil-square"></i>
								    </button>
								    <button class="btn btn-outline-danger" title="Excluir computador" onclick="excluir(${i.id})">
								      <i class="bi bi-trash"></i>
								    </button>
								  </div>
								</td>

						      </tr>`;
						      $('#tabela-computadores').append(itens);
	
						      // Card
						      var card = `
						        <div class="col-md-6 col-lg-4" id="card-${i.id}">
						          <div class="card card-computador">
						            <div class="card-body">
						              <h5 class="card-title"><td>${statusHTML}</td> ${i.cliente} - ${i.name}</h5>
						              <p><strong>Domínio:</strong> ${i.domain}</p>
									  <p><strong>Comentário:</strong> ${i.comment != null ? i.comment: ' '}</p>
						              <p><strong>Usuário:</strong> ${i.username}</p>
						              <p><strong>SO:</strong> ${i.os}</p>
						              <p><strong>CPU:</strong> ${i.cpu}</p>
						              <p><strong>RAM:</strong> ${i.ram} (Disponível: ${i.ramAvailable})</p>
						              <p><strong>Armazenamento:</strong> ${i.disk && i.disk.length ? i.disk.join(', ') : ''}</p>
						              <p><strong>Disponível:</strong>  ${i.diskAvailable && i.diskAvailable.length ? i.diskAvailable.join('<br>') : ''}</p>
						              <p><strong>Fabricante:</strong> ${i.manufacturer}</p>
									  <p><strong>Bitlocker:</strong>  ${i.bitlockerRecoveryKeys && i.bitlockerRecoveryKeys.length ? i.bitlockerRecoveryKeys.join('<br>') : ''}</p>
									  <p><strong>Antivirus:</strong> ${i.antivirus}</p>
									  <p><strong>Serial:</strong> ${i.serial}</p>
						              <p><strong>IP:</strong> ${i.ipAddresses && i.ipAddresses.length ? i.ipAddresses.join(', ') : ''}</p>
						              <p><strong>MAC:</strong> ${i.mac}</p>
						              <p><strong>Boot:</strong> ${i.last_boot_time}</p>
						              <p><strong>Última Atualização:</strong> ${i.last_seen}</p>
						              <button class="btn btn-sm btn-danger" onclick="excluir(${i.id})">Excluir</button>
						            </div>
						          </div>
						        </div>`;
						      $('#visualizacao-cards').append(card);
					  });
					},
					statusCode: {
					  	500: function() { alert('Erro! Contate o desenvolvedor!'); },
					    401: function() { alert('Realize login novamente!'); }
					}
				});
			}else{
				alert("Selecione o cliente!");
			}
			
		}
		
		function excluir(id) {
		    if (confirm("Tem certeza que deseja excluir o ID " + id + "?")) {
				$.ajax({
					type: "DELETE",
					contentType: "application/json",
					url: "/sistech/api/v1/computador/" + id,
					success: function () {
						document.getElementById("linha" + id)?.remove();
						document.getElementById("card-" + id)?.remove();
					},
					error: function (e) { alert("Não foi possível excluir"); }
				});
		    }
		  }
		
	</script>
	<script>
		$(document).ready(function() {
		  $(".search").keyup(function () {
		    var searchTerm = $(".search").val();
		    var listItem = $('.results tbody').children('tr');
		    var searchSplit = searchTerm.replace(/ /g, "'):containsi('")
		    
		  $.extend($.expr[':'], {'containsi': function(elem, i, match, array){
		  		return (elem.textContent || elem.innerText || '').toLowerCase().indexOf((match[3] || "").toLowerCase()) >= 0;
		    }
		  });
		    
		  $(".results tbody tr").not(":containsi('" + searchSplit + "')").each(function(e){
		    $(this).attr('visible','false');
		  });
		
		  $(".results tbody tr:containsi('" + searchSplit + "')").each(function(e){
		    $(this).attr('visible','true');
		  });
		
		  var jobCount = $('.results tbody tr[visible="true"]').length;
		    $('.counter').text(jobCount + ' item');
		
		  if(jobCount == '0') {$('.no-result').show();}
		    else {$('.no-result').hide();}
				  });
		});
	</script>
</body>
</html>