<!DOCTYPE html>
<html lang="pt-BR">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" href="../assets/img/favicon.ico">
	<link rel="stylesheet" href="../assets/css/defaultStyle.css">
	<link rel="stylesheet" href="../assets/css/styleBusca.css">
	<link rel="stylesheet" href="../assets/css/bootstrap.min.css">
	<link rel="stylesheet" href="../assets/css/StyleSolicitacao.css">
	<link rel="stylesheet" href="../assets/css/password-generator.css">
	<link rel="stylesheet" href="../assets/css/StyleSolicitacaoFinalizada.css">
	<link rel="stylesheet" href="../assets/css/bootstrap-icons.min.css">
	<link rel="stylesheet" href="../assets/css/dark.css">
	<title>Sistech | Relatórios</title>
	<style>
		body.dark-mode table {
		  background-color: #212529;
		  color: #f8f9fa;
		}

		body.dark-mode th,
		body.dark-mode td {
		  background-color: rgb(119, 118, 123);
		  color: #f8f9fa;
		  border-color: #343a40;
		}

		body.dark-mode .table-striped > tbody > tr:nth-of-type(odd) {
		  background-color: #2c3034;
		  color: #f8f9fa !important;
		}

		body.dark-mode .table-hover tbody tr:hover {
		  background-color: #343a40;
		  color: #f8f9fa !important;
		}

		body.dark-mode .table-primary {
		  background-color: #0d6efd;
		  color: #fff;
		}


		</style>
</head>
<body>
	<div class="container-fluid">
		<!-- ###################################### BARRA DE NAVEGAÇÃO ###################################### -->
		<nav class="navbar navbar-expand-lg bg-light">
			<div class="container-fluid">
				<a class="navbar-brand" href="/sistech/home"><img src="../assets/img/key.png" style="height: 18px;"> SisTech</a>
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse"
					data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarSupportedContent">
					<ul class="navbar-nav me-auto mb-2 mb-lg-0">
						<li class="nav-item"><a class="nav-link active" aria-current="page" href="/sistech/home">Início</a></li>
							<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Solicitações</a>
							<ul class="dropdown-menu">
								<li><a class="dropdown-item" href="/sistech/solicitacao/form">Novo</a></li>
								<li><a class="dropdown-item" href="/sistech/solicitacao/list">Listar</a></li>
								<li><hr class="dropdown-divider"></li>
								<li><a class="dropdown-item" href="/sistech/solicitacao/modelos">Modelos</a></li>	
								<li><hr class="dropdown-divider"></li>
								<li><a class="dropdown-item" href="/sistech/solicitacao/relatorios">Relatórios</a></li>
							</ul>
						</li>
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Clientes</a>
							<ul class="dropdown-menu">
								<li><a class="dropdown-item" href="/sistech/cliente/list">Listar</a></li>
								<li><a class="dropdown-item" href="/sistech/cliente/form">Novo</a></li>
							</ul>
						</li>
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Funcionarios</a>
							<ul class="dropdown-menu">
								<li><a class="dropdown-item" href="/sistech/funcionario/list">Listar</a></li>
								<li><a class="dropdown-item" href="/sistech/funcionario/form">Novo</a></li>
							</ul>
						</li>
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Dashboard</a>
							<ul class="dropdown-menu">
								<li><a class="dropdown-item" href="/dashboard/inicio" target="_blank" style="color: brown; font-weight: bold;">Realtime <i class="bi bi-speedometer2"></i></a></li>
								<li><a class="dropdown-item" href="/sistech/solicitacao/dashboard/geral">Solicitações ativas</a></li>
								<li><a class="dropdown-item" href="/sistech/solicitacao/dashboard/funcionario">Funcionario</a></li>
								<li><a class="dropdown-item" href="/sistech/solicitacao/dashboard/cliente">Cliente</a></li>
							</ul>
						</li>
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Ferramentas</a>
							<ul class="dropdown-menu">
								<li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#modalPasswordGenerator">Password Generator</a></li>
								<li><a class="dropdown-item" href="/sistech/avisos">Avisos</a></li>
								<li><a class="dropdown-item" href="/sistech/calendario">Calendário</a></li>
							</ul>
						</li>
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle color-text" href="#" role="button" data-bs-toggle="dropdown"aria-expanded="false">Computadores</a>
							<ul class="dropdown-menu">
								<li><a class="dropdown-item" href="/sistech/computador/list">Listar</a></li>
							</ul>
						</li>
					</ul>
					<span class="nav-item">
						  <button class="btn btn-sm btn-outline-secondary" onclick="toggleDarkMode()" id="toggleDarkBtn">
						    <i class="bi bi-moon"></i> Modo Escuro
						  </button>
						</span>
						&nbsp; &nbsp; &nbsp; &nbsp;
					<div class="d-flex">
				        <input class="form-control me-2" type="search" placeholder="Busca avançada" aria-label="Search" id="palavraChave">
				        <button class="btn btn-sm btn-outline-success" onclick="buscaPorPalavra()" >Buscar</button>
					</div>
					<ul></ul><ul></ul>
					<ul class="navbar-nav mb-3 mb-lg-0">
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" id="perfil" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"> </a>
							<ul class="dropdown-menu">
								<li><a class="dropdown-item" href="/sistech/funcionario/perfil">Perfil</a></li>
								<li><hr class="dropdown-divider"></li>
								<li><a class="dropdown-item" href="/sistech/gerencia">Gerência</a></li>
								<li><a class="dropdown-item" href="/sistech/configuracoes">Configurações</a></li><li>
								<li><hr class="dropdown-divider"></li>
								<li><a class="dropdown-item" href="/sistech/sobre">Sobre</a></li>
							</ul>
						</li>
							<a href="/sistech/logout"><i class="bi bi-power"style="font-size: 2rem; color: red;"> </i></a>
					</ul>
				</div>
			</div>
		</nav>
		<!-- ###################################### BARRA DE NAVEGAÇÃO ###################################### -->
		<hr class="bg-danger border-2 border-top border-danger">
		<div class="container-fluid">
				<input type="hidden" id="linkPage" name="linkPage">
				<div align="center">
					<div id="">
						<p><a id="abertoHoje" class="btn btn-primary btn-tamanho-padrao rederiza-medio" href="#" onclick="abertoHoje()" role="button">Aberto Hoje <b><span id="btnAbertosHoje"> </span></b></a>
						<a id="finalizadoHoje" class="btn btn-primary btn-tamanho-padrao rederiza-medio" href="#" onclick="finalizadoHoje()" role="button">Finalizados Hoje <b><span id="btnFinalizadosHoje"> </span></b></a>
						<a id="atualizadoHoje" class="btn btn-primary btn-tamanho-padrao rederiza-medio" href="#" onclick="atualizadoHoje()" role="button">Atualizados Hoje <b><span id="btnAtualizadosHoje"> </span></b></a>
						<a id="agendadoHoje" class="btn btn-primary btn-tamanho-padrao rederiza-medio" href="#" onclick="agendadoHoje()" role="button">Agendamentos Hoje <b><span id="btnAgendadosHoje"> </span></b></a>
						<a id="atrasadas" class="btn btn-primary btn-tamanho-padrao rederiza-medio" href="#" onclick="atrasadas()" role="button">Agendamentos Atrasados <b><span id="btnAtrasadosHoje"> </span></b></a></p>

						<p><a id="periodoAbertura" class="btn btn-primary btn-tamanho-padrao rederiza-medio" href="/sistech/solicitacao/relatoriosperiodo" role="button">Por Período</a>
						<a id="porCliente" class="btn btn-primary btn-tamanho-padrao rederiza-medio" href="/sistech/solicitacao/relatoriosclientes" role="button">Por Cliente </a>
						<a id="porTecnico" class="btn btn-primary btn-tamanho-padrao rederiza-medio" href="/sistech/solicitacao/relatoriostecnicos" role="button">Por Tecnico </a>
						<a id="porFinalizadas" class="btn btn-primary btn-tamanho-padrao rederiza-medio" href="/sistech/solicitacao/finalizadas" role="button">Finalizadas</a>
						<a id="porExcluidas" class="btn btn-primary btn-tamanho-padrao rederiza-medio" href="/sistech/solicitacao/excluidas" role="button">Solicitações Excluídas</a></p>
					</div>
					
				</div>
			<legend> </legend>
			
		<div class="container-fluid">
		  <div class="row">
		    <div class="col-3">
				<a href="/sistech/solicitacao/form" class="btn btn-primary btn-sm">Nova </a>
		    </div>
		    <div class="col-4">
				<b><span style="font-size: 24px;" id="totalElementos"> </span></b>
		    </div>
		    <div class="col-1">
				<a href="/sistech/solicitacao/relatorios"> <i class="bi bi-arrow-clockwise" style="font-size: 1.7rem; color: cornflowerblue;"> </i></a>
		    </div>
		    <div class="col-4">
				<div class="form-group pull-right">
		    		<input id="boxBusca" type="text" class="search form-control" placeholder="Busca">
				</div>
				<span class="counter pull-right"> </span>
		    </div>
		</div>
		</div>
			<div class="table-responsive">
				<table id="tabela-resultados" class="table table-striped" style="text-align: center;">
					<thead>
					<tr class="table-primary">
						<th data-field="nome" data-sortable="true">Nome</th>
						<th data-field="qtdAberto" data-sortable="true">Abertos</th>
						<th data-field="qtdAndamento" data-sortable="true">Andamentos</th>
						<th data-field="qtdAgendado" data-sortable="true">Agendados</th>
						<th data-field="qtdAguardando" data-sortable="true">Aguardando</th>
						<th data-field="qtdPausado" data-sortable="true">Pausado</th>
						<th data-field="qtdTotal" data-sortable="true">Total</th>
					</tr>
					</thead>
						<tr class="tabela"> </tr>
				</table>
			</div>
			<div class="table-responsive">
				<table  class="table table-hover table-striped table-bordered align-middle results sortable table-action" id="tabela-solicitacoes" style="text-align: center; display: none;">
					<thead>
						<tr class="table-light">
							<th scope="col">ID</th>
							<th scope="col">Data Abertura</th>
							<th scope="col">Cliente</th>
							<th scope="col">Solicitante</th>
							<th scope="col">Afetado</th>
							<th scope="col">Classificações</th>
							<th scope="col">Descrição</th>
							<th scope="col">Criticidade</th>
							<th scope="col">Classificação</th>
							<th scope="col">Responsável</th>
							<th scope="col">Status</th>
							<th scope="col">Duração <span style="font-size: 10px;"> (minutos)</span></th>
							<th scope="col">Versão</th>
						</tr>
					</thead>
					<tbody id="corpoSolicitacoes">
						<tr> </tr>
					</tbody>
				</table>
				<nav aria-label="Page navigation example">
				  <ul id="paginas" class="pagination"> </ul>
				</nav>
			</div>
		</div>
		<br /><br />
		<legend> </legend>
		</fieldset>

		<!-- ####################################################  MODAL EDIÇÃO FINALIZADO ######################################################## -->
		<div class="modal fade" id="edicaoModal" tabindex="-1" aria-labelledby="edicaoModal" aria-hidden="true">
			<div class="modal-dialog modal-lg">
				<div class="modal-content">
					<div class="modal-header">
						<h1 class="modal-title fs-6" id="edicaoModal"><span id="nomeClienteModalFinalizado"> </span> - Edição rápida ID:
							<span id="idModalEdicaoModalEdicao"> </span></h1>&nbsp; &nbsp;
							<button class="btn btn-sm btn btn-historico" data-bs-toggle="modal" data-bs-target="#modalHistorico" onclick="exibeHistoricoFinalizado()">Histórico</button>
							&nbsp; &nbsp;<span id="btnTimesheet"> </span>
							<span hidden id="idHistoricoModalEdicao"> </span>
						
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"> </button>
					</div>
					<div class="modal-body">
						<div class="row">
							<div class="col-md-4">
								<div class="control-group">
									<label class="form-label mt-2 fonteModal"><b>Data Abertura *</b></label>
									<div class="calendarioAberturaModal">
										<input type="date" id="dataAberturaModalEdicao" name="dataAberturaModalEdicao" value="" style="width: 112px;">
										<span> </span>
										<input type="time" id="horaAberturaModalEdicao" name="horaAberturaModalEdicao" value="">
									</div>
								</div>
							</div>
								<div class="col-md-4">
									<div class="control-group">
										<label class="form-label mt-2 fonteModal"><b>Data Andamento *</b></label>
										<div class="calendarioAndamentoModal">
											<input type="date" id="dataAndamentoModalEdicao" name="dataAndamentoModalEdicao" value="" style="width: 112px;">
											<span> </span>
											<input type="time" id="horaAndamentoModalEdicao" name="horaAndamentoModalEdicao" value="">
										</div>
									</div>
								</div>
							<div class="col-md-4 ms-auto">
								<div class="control-group fonteModal">
									<label class="form-label mt-2 fonteModal"><b>Data Finalizado *</b></label>
									<div class="calendarioFinalizadoModal">
										<input type="date" id="dataFinalizadoModalEdicao" name="dataFinalizadoModalEdicao" value="" style="width: 112px;">
										<span> </span>
										<input type="time" id="horaFinalizadoModalEdicao" name="horaFinalizadoModalEdicao" value="">
									</div>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-4">
								<div class="form-group mt-2">
									<label class="control-label"><b>Solicitante * </b>
										<span id="botaoColaboradores"> </span>
									</label>
									<div class="controls">
										<select class="form-control mt-2" name="solicitantemodal" id="solicitantemodal"> </select>
									</div>
								</div>
							</div>
							<div class="col-md-4">
								<div class="control-group mt-2">
									<label class="form-label" for="afetadomodal"><b>Usuário Afetado *</b></label>
									<div class="controls">
										<select class="form-control" name="afetadomodal" id="afetadomodal"> </select>
									</div>
								</div>
							</div>
							<div class="col-md-4">
								<div class="control-group mt-2">
									<label class="control-label" for="formaaberturamodal"><b>Canal de Abertura</b></label>
									<div class="controls">
										<select class="form-select mt-2" id="formaaberturamodal" name="formaaberturamodal"> </select>
									</div>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-4">
								<div class="control-group fonteModal">
									<label class="form-label mt-2" for="localmodal"><b>Local</b></label>
									<select class="form-select" id="localmodal" aria-label="Default select example">
									</select>
								</div>
							</div>
							<div class="col-md-4">
								<div class="control-group fonteModal">
									<label class="form-label mt-2" for="nomefuncionariomodal"><b>Técnico Responsável</b></label>
									<div class="controls">
										<select class="form-select" id="nomefuncionariomodal" name="nomefuncionariomodal">
										</select>
									</div>
								</div>
							</div>
							<div class="col-md-4">
								<label class="form-label mt-2" for="prioridademodal"><b>Criticidade</b></label>
								<div class="controls fonteModal">
									<select class="form-select" id="prioridademodal" name="prioridademodal">
										<option value="BAIXA">Baixa</option>
										<option value="MEDIA">Media</option>
										<option value="ALTA">Alta</option>
										<option value="CRITICA">Crítico</option>
										<option value="PLANEJADA">Planejada</option>
									</select>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-4">
								<label class="form-label mt-3" for="categoriamodal"><b>Categoria</b></label>
								<div class="controls fonteModal">
									<select class="form-select" id="categoriamodal" name="categoriamodal">
										<option value="SOFTWARE">Software</option>
										<option value="HARDWARE">Hardware</option>
										<option value="EMAIL">Email</option>
										<option value="SHAREPOINT">SharePoint</option>
										<option value="INTERNET">Internet</option>
										<option value="SERVIDORES">Servidores</option>
										<option value="OUTROS">Outros</option>
										<option value="REDE">Rede</option>
										<option value="CABEAMENTO">Cabeamento</option>
										<option value="SMARTPHONE">Smartphone</option>
										<option value="PROJETO">Projeto</option>
										<option value="BACKUP">Backup</option>
										<option value="COTACAO">Cotação</option>
										<option value="MIGRACAO">Migração</option>
										<option value="DOMINIOS">Domínios</option>
										<option value="HOSPEDAGENS">Hospedagens</option>
									</select>
								</div>
							</div>
							<div class="col-md-4">
								<label class="form-label mt-3" for="classificacaomodal"><b>Classificação</b></label>
								<div class="controls fonteModal">
									<select class="form-select" id="classificacaomodal" name="classificacaomodal">
										<option value="INCIDENTE">Incidente</option>
										<option value="PROBLEMA">Problema</option>
										<option value="SOLICITACAO">Solicitação</option>
										<option value="ACESSO">Acesso</option>
										<option value="EVENTO">Evento</option>
										<option value="BACKUP">Backup</option>
									</select>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-6 ms-auto fonteModal">
								<label class="form-label mt-3" for="descricaomodal"><b>Descrição</b></label>
								<textarea class="form-control" rows="3" id="descricaomodal" class="form-control" spellcheck="true"> </textarea>
							</div>
							<div class="col-md-6 ms-auto fonteModal">
								<label class="form-label mt-3" for="observacaomodal"><b>Observação</b></label>
								<textarea class="form-control" rows="3" id="observacaomodal" class="form-control" spellcheck="true"> </textarea>
							</div>
						</div>
						<label class="form-label mt-3 fonteModal" for="resolucaomodal"><b>Resolução</b></label>
						<textarea class="form-control" rows="3" id="resolucaomodal" class="form-control" spellcheck="true"> </textarea>
						<div class="row">
							<div class="col-md-12 mt-3">
								<b><span id="dataAtualizacaoModalEdicao"></span></b>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button class="btn btn-info btn-sm" data-toggle="tooltip" data-placement="top" title="Migrar a solicitação" data-bs-toggle="modal" data-bs-target="#modalMigrarSolicitacao" onclick=migrarSolicitacao()><i class="bi bi-building-gear"></i></button>
						<button class="btn btn-danger btn-sm" data-toggle="tooltip" data-placement="top" title="Excluir a solicitação" onclick=excluir()><i class="bi bi-trash"> </i></button>
						<button class="btn btn-warning btn-sm" data-toggle="tooltip" data-placement="top" title="Cancelar a solicitação" onclick=cancelar()><i class="bi bi-x-octagon"> </i></button>
						<button class="btn btn-dark btn-sm" data-toggle="tooltip" data-placement="top" title="Notificar cliente" onclick=notificarCliente()><i class="bi bi-envelope"></i></i></button>
						<button class="btn btn-secondary btn-sm" data-toggle="tooltip" data-placement="top" title="Imprimir a solicitação" onclick=print()><i class="bi bi-printer"> </i></button>
						<button class="btn btn-info" data-toggle="tooltip" data-placement="top" title="Clonar a solicitação" data-bs-toggle="modal" data-bs-target="#modalNovaSolicitacao" onclick=clonar()><i class="bi bi-copy"> </i></button>
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal" aria-label="Close">Fechar </button>
						<button type="button" class="btn btn-primary" onclick="atualiza()">Salvar</button>
					</div>
				</div>
			</div>
		</div>
		<!-- ####################################################  MODAL EDIÇÃO FINALIZADO ######################################################## -->
		<!-- ################################################  MODAL EDIÇÃO NÃO FINALIZADO ######################################################## -->
		<div class="modal fade" id="edicaoModalNaoFinalizado" tabindex="-1" aria-labelledby="edicaoModalNaoFinalizado" aria-hidden="true">
			<div class="modal-dialog modal-lg">
				<div class="modal-content">
					<div class="modal-header">
						<h1 class="modal-title fs-6" id="edicaoModalNaoFinalizado">Edição rápida ID: <span id="idModalNaoFinalizado"> </span></h1>
						&nbsp; &nbsp;<button class="btn btn-sm btn-historico" data-bs-toggle="modal" data-bs-target="#modalHistorico" onclick="exibeHistoricoNaoFinalizado()">Histórico</button>
						&nbsp; &nbsp;<span id="btnTimesheetNaoFinalizado"> </span>
							<span hidden id="idHistoricoModalEdicaoNaoFinalizado"> </span>
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"> </button>
					</div>
					<div class="modal-body">
						<span id="id_cliente" style="display: none;" > </span>
						<div class="row">
							<div class="col-md-4">
								<div class="controls">
									<label class="form-label mt-2" for="localModalNaoFinalizado"><b>Local</b></label>
									<select class="form-select" id="localModalNaoFinalizado" aria-label="Default select example"> </select>
								</div>
							</div>
							<div class="col-md-4">
								<label class="form-label mt-2" for="nomeFuncionarioModalNaoFinalizado"><b>Técnico</b></label>
								<div class="controls">
									<select class="form-select" id="nomeFuncionarioModalNaoFinalizado" name="nomeFuncionarioModalNaoFinalizado">
										<option> </option>
									</select>
								</div>
							</div>
							<div class="col-md-4 ms-auto" id="divstatusmodal">
								<label class="form-label mt-2" for="statusModalNaoFinalizado"><b>Status</b></label>
								<div class="controls">
									<select class="form-select" id="statusModalNaoFinalizado" aria-label="Default select example"> </select>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-8-auto" id="agendamentosmodal" style="display: none">
								<div class="control-group">
									<label class="form-label mt-4"><b>Data Agendamento *</b></label>
									<div class="datetimepickerModal">
										<input type="date" id="dataModalNaoFinalizado" name="dataModalNaoFinalizado" value="">
										<span> </span>
										<input type="time" id="horaModalNaoFinalizado" name="horaModalNaoFinalizado" value="">
									</div>
									<div class="info">
										<strong>Compatibility check:</strong>
										Date "<span id="date-output"> </span>",
										Time "<span id="time-output"> </span>"
									</div>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-4">
								<div class="form-group mt-3">
									<label class="control-label"><b>Solicitante *</b>
										<span id="botaoColaboradores"> </span>
									</label>
									<div class="controls">
										<select class="form-control solicitante mt-3" name="nomeSolicitanteModalNaoFinalizado" id="nomeSolicitanteModalNaoFinalizado"> </select>
									</div>
								</div>
							</div>
							<div class="col-md-4">
								<div class="control-group mt-3">
									<label class="form-label" for="nomeAfetadoModalNaoFinalizado"><b>Usuário Afetado *</b></label>
									<div class="controls">
										<select class="form-control usuario mt-2" name="nomeAfetadoModalNaoFinalizado" id="nomeAfetadoModalNaoFinalizado"> </select>
									</div>
								</div>
							</div>
							<div class="col-md-4">
								<div class="control-group mt-3">
									<label class="control-label mt-2" for="formaAberturaModalNaoFinalizado"><b>Canal de Abertura</b></label>
									<div class="controls">
										<select class="form-select mt-2" id="formaAberturaModalNaoFinalizado" name="formaAberturaModalNaoFinalizado"> </select>
									</div>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-4">
								<div class="form-group mt-2">
									<span style="color: blue;"  id="celSolicitante"> </span>
								</div>
							</div>
							<div class="col-md-4">
								<div class="control-group mt-2">
									<span style="color: blue;"  id="celAfetado"> </span>
								</div>
							</div>
							<div class="col-md-4">
								<div class="control-group mt-2"> </div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-4 ms-auto">
								<label class="form-label mt-3" for="categoriaModalNaoFinalizado"><b>Categoria</b></label>
								<div class="controls">
									<div class="controls">
										<select class="form-select" id="categoriaModalNaoFinalizado" name="categoriaModalNaoFinalizado">
											<option value="SOFTWARE">Software</option>
											<option value="HARDWARE">Hardware</option>
											<option value="EMAIL">Email</option>
											<option value="SHAREPOINT">SharePoint</option>
											<option value="INTERNET">Internet</option>
											<option value="SERVIDORES">Servidores</option>
											<option value="OUTROS">Outros</option>
											<option value="REDE">Rede</option>
											<option value="CABEAMENTO">Cabeamento</option>
											<option value="SMARTPHONE">Smartphone</option>
											<option value="PROJETO">Projeto</option>
											<option value="BACKUP">Backup</option>
											<option value="DOMINIOS">Domínios</option>
											<option value="HOSPEDAGENS">Hospedagens</option>
										</select>
									</div>
								</div>
							</div>
							<div class="col-md-4 ms-auto">
								<label class="form-label mt-3" for="classificacaoModalNaoFinalizado"><b>Classificação</b></label>
								<div class="controls">
									<select class="form-select" id="classificacaoModalNaoFinalizado" name="classificacaoModalNaoFinalizado">
										<option value="INCIDENTE">Incidente</option>
										<option value="PROBLEMA">Problema</option>
										<option value="SOLICITACAO">Solicitação</option>
										<option value="ACESSO">Acesso</option>
										<option value="EVENTO">Evento</option>
										<option value="BACKUP">Backup</option>
									</select>
								</div>
							</div>
							<div class="col-md-4 ms-auto">
								<label class="form-label mt-3" for="prioridadeModalNaoFinalizado"><b>Criticidade</b></label>
								<div class="controls">
									<select class="form-select" id="prioridadeModalNaoFinalizado" name="prioridadeModalNaoFinalizado">
									</select>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-6 ms-auto">
								<label class="form-label mt-3" for="descricaoModalNaoFinalizado"><b>Descrição</b></label>
								<div class="controls">
									<textarea class="form-control" rows="3" id="descricaoModalNaoFinalizado" class="form-control" spellcheck="true"></textarea>
								</div>
							</div>
							<div class="col-md-6 ms-auto">
								<label class="form-label mt-3" for="observacaoModalNaoFinalizado"><b>Observação</b></label>
								<div class="controls">
									<textarea class="form-control" rows="3" id="observacaoModalNaoFinalizado" class="form-control" spellcheck="true"></textarea>
								</div>
							</div>
						</div>
						<div class="row">
							<label class="form-label mt-3" for="resolucaoModalNaoFinalizado"><b>Resolução</b></label>
							<div class="controls">
								<textarea class="form-control" rows="3" id="resolucaoModalNaoFinalizado" class="form-control" spellcheck="true"> </textarea>
							</div>
						</div>
						<div class="row">
							<div class="col-md-12 mt-3">
								<div class="controls">
									<b><span id="dataAtualizacaoModalNaoFinalizado"> </span></b>
								</div>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button class="btn btn-danger btn-sm" data-toggle="tooltip" data-placement="top" title="Excluir a solicitação" onclick=excluir()><i class="bi bi-trash"> </i></button>
						<button class="btn btn-dark btn-sm" data-toggle="tooltip" data-placement="top" title="Notificar cliente" onclick=notificarCliente()><i class="bi bi-envelope"></i></i></button>
						<button class="btn btn-warning btn-sm" data-toggle="tooltip" data-placement="top" title="Cancelar a solicitação" onclick=cancelar()><i class="bi bi-x-octagon"> </i></button>
						<button class="btn btn-secondary btn-sm" data-toggle="tooltip" data-placement="top" title="Imprimir a solicitação" onclick=print()><i class="bi bi-printer"> </i></button>
						<button class="btn btn-info" data-toggle="tooltip" data-placement="top" title="Clonar a solicitação" data-bs-toggle="modal" data-bs-target="#modalNovaSolicitacao" onclick=clonar()><i class="bi bi-copy"> </i></button>
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal" aria-label="Close">Fechar </button>
						<button type="button" class="btn btn-primary" data-toggle="tooltip" data-placement="top" title="Salvar a solicitação" onclick="atualizaNaoFinalizado()">Salvar</button>
					</div>
				</div>
			</div>
		</div>
		<!-- #################################  MODAL EDIÇÃO NÃO FINALIZADO ######################################################## -->
		<!-- ################################################### MODAL HISTORICO ############################################# -->
		<div class="modal fade" id="modalHistorico" tabindex="-1" aria-labelledby="modalHistorico" aria-hidden="true">
			<div class="modal-dialog modal-lg">
				<div class="modal-content">
					<div class="modal-header">
						<h1 class="modal-title fs-5" id="modalHistorico">Histórico de Solicitação</h1>
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"> </button>
					</div>
					<div class="modal-body">
						<div class="row">
							<div class="col-md-12">
								<label class="form-label mt-3" for="log"><b>LOG</b></label>
								<div class="controls">
									<textarea class="form-control" rows="20" id="log" class="form-control"></textarea>
								</div>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
					</div>
				</div>
			</div>
		</div>
		<!-- ########################################## MODAL HISTORICO ############################################# -->
		<!-- ################################################### MODAL MIGRAR SOLICITACAO ############################################# -->
				<div class="modal fade" id="modalMigrarSolicitacao" tabindex="-1" aria-labelledby="modalMigrarSolicitacao" aria-hidden="true">
					<div class="modal-dialog modal-lg">
						<div class="modal-content">
							<div class="modal-header">
								<h1 class="modal-title fs-5" id="modalHistorico">Migração de Solicitação de Cliente - ID: <span id="idModalMigracao"> </span></h1>
								<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"> </button>
							</div>
							<div class="modal-body">
								<div class="row">
									<div class="col-md-12">
										<div class="control-group">
											<label class="control-label" for="nomeClienteMigracao"><b>Cliente *</b></label>
											<div class="controls">
												<select class="form-select mt-2" id="nomeClienteMigracao" name="nomeClienteMigracao">
												</select>
											</div>
										</div>
										<br />
									</div>
								</div>
								
								<div class="row">
									<div class="col-md-6">
										<div class="form-group">
											<label class="control-label" for="solicitanteMigracao"><b>Solicitante * </b>
												<span id="botaoColaboradores"> </span>
											</label>
											<div class="controls">
												<select class="form-control solicitante mt-3" name="solicitanteMigracao" id="solicitanteMigracao"> </select>
											</div>
										</div>
									</div>
									<div class="col-md-6">
										<div class="control-group">
											<label class="form-label" for="afetadoMigracao"><b>Usuário Afetado *</b></label>
											<div class="controls">
												<select class="form-control usuario mt-2" name="afetadoMigracao" id="afetadoMigracao"> </select>
											</div>
										</div>
									</div>
								</div>
								
							</div>
							<div class="modal-footer">
								<span id="botaoSalvar"> </span>
								<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
							</div>
						</div>
					</div>
				</div>
		<!-- ########################################## MODAL MIGRAR SOLICITACAO ############################################# -->
		<!-- ############################################ MODAL PASSWORD GENERATOR ########################################## -->
		<div class="modal fade" id="modalPasswordGenerator" tabindex="-1" aria-labelledby="modalPasswordGenerator"
			aria-hidden="true">
			<div class="modal-dialog modal-md">
				<div class="modal-content">
					<div class="container-password">
						<div class="result">
							<div class="result__info right">click para copiar</div>
							<div class="result__info left">copiado</div>
							<div class="result__viewbox" id="result" style="color: aliceblue; "></div>
							<a id="copy-btn" style="--x: 0; --y: 0"><i class="far fa-copy"></i></a>
						</div>
						<div class="length range__slider" data-min="4" data-max="32">
							<div class="length__title field-title" data-length='0'>Tamanho:</div>
							<input id="slider" type="range" min="4" max="32" value="16" />
						</div>
						<div class="settings">
							<span class="settings__title field-title">configurações</span>
							<div class="setting">
								<input type="checkbox" id="uppercase" checked />
								<label for="uppercase">Incluir Maiúsculo</label>
							</div>
							<div class="setting">
								<input type="checkbox" id="lowercase" checked />
								<label for="lowercase">Incluir Minúsculo</label>
							</div>
							<div class="setting">
								<input type="checkbox" id="number" checked />
								<label for="number">Incluir Número</label>
							</div>
							<div class="setting">
								<input type="checkbox" id="symbol" />
								<label for="symbol">Incluir Símbolo</label>
							</div>
						</div>
						<button class="btn generate" id="generate">Gerar Senha</button>
					</div>
				</div>
			</div>
		</div>
		<!-- ############################################ MODAL PASSWORD GENERATOR ########################################## -->
		<!-- ###################################### MODAL LISTA TIMESHEET SOLICITACAO ####################################### -->
		<div class="modal fade" id="modalTimesheetSolicitacao" tabindex="-1" aria-labelledby="modalTimesheetSolicitacao" aria-hidden="true">
			<div class="modal-dialog modal-xl">
				<div class="modal-content">
					<div class="modal-header">
						<h1 class="modal-title fs-5" id="finalizadosModal">  <span id="idmodal"> </span></h1><span style="color: #0101DF;">Lista de tempos da solicitação</span> 
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"> </button>
					</div>
					<div class="modal-body">
						<div class="table-responsive mt-3">
						<table class="table table-hover table-bordered table-striped results sortable" id="tabela-timesheet" style="text-align: center;">
							<thead>
								<tr>
									<th scope="col">ID</th>
									<th scope="col">Funcionário</th>
									<th scope="col">Início</th>
									<th scope="col">Fim</th>
									<th scope="col">Duração <span style="font-size: 10px;"> (minutos)</span></th>
									<th scope="col">Status</th>
								</tr>
							</thead>
							<tbody id="tabela-timesheet-corpo">
								<tr> </tr>
							</tbody>
						</table>
					</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
					</div>
				</div>
			</div>
		</div>
		<!-- ###################################### MODAL LISTA TIMESHEET SOLICITACAO ####################################### -->
		<br /><br />
		<footer class="container-fluid fixed-bottom text-center text-white">
				<div class="text-center" style="background-color: rgba(0, 0, 0, 0.2);">
					2025 Copyright:
					<a class="text-white" href="#">Techgold</a>
				</div>
		</footer>
	</div>
	<script src="../assets/js/jquery-3.6.3.js"></script>
	<script src="../assets/js/popper.min.js"></script>
	<script src="../assets/js/bootstrap.min.js"></script>
	<script src="../assets/js/sorttable.js"></script>
	<script src="../assets/js/password-generator.js"></script>
	<script src="../assets/js/dark.js"></script>
	<script>
		
		$(document).ready(function () {
			var divCliente = $("#nomeClienteMigracao");
			divCliente.on("change", function () {
				preencheSolicitanteMigracao();
			});
		});
				
		function preencheSolicitanteMigracao(){
				var idCliente = $("#nomeClienteMigracao").val();
				var json = {"nomeCliente": idCliente};
			
				if(idCliente > 0){
					$("#botaoSalvar").empty();
					$('#botaoSalvar').append(
						'<button id="enviar" name="salvar" class="btn btn-success" onclick="salvarMigracao()">Salvar <i class="fa fa-floppy-o fa-lg"></i></button>'
					);
					
					$.ajax({
					url: "/sistech/colaborador/list/" + idCliente,
					type: "GET",
					data: json,
					success: function (data) {

						if (data != null) {
							
							var boxSolicitante = $('#solicitanteMigracao');
							boxSolicitante.find('option').remove();

							var boxAfetado = $('#afetadoMigracao');
							boxAfetado.find('option').remove();

							$('#boxSolicitante').append('<option value="" slected="selected"></option>');
							$('#boxAfetado').append('<option value="" slected="selected"></option>');

							$.each(data, function (i, item) {
								$('#solicitanteMigracao').append('<option value="' + item.nomeColaborador + '" slected="selected">' + item.nomeColaborador + '</option>');
							});
							$('#solicitanteMigracao').append('<option value="Suporte" slected="selected">Suporte</option>');
							$('#solicitanteMigracao').append('<option value="Geral" slected="selected">Geral</option>');

							$.each(data, function (i, item) {
								$('#afetadoMigracao').append('<option value="' + item.nomeColaborador + '" slected="selected">' + item.nomeColaborador + '</option>');
							});
							$('#afetadoMigracao').append('<option value="Suporte" slected="selected">Suporte</option>');
							$('#afetadoMigracao').append('<option value="Geral" slected="selected">Geral</option>');
							
							var id_cliente = $('#nomeClienteMigracao').val();
							var nomeSolicitante = $("#solicitanteMigracao").val();
							
						}
					},
					statusCode: {
				    	500: function() { alert('Erro! Contate o desenvolvedor!'); },
						401: function() { 
							alert('Realize login novamente!'); 
							window.location.href = "/sistech/login"; 
						}
					},
					complete: function (data) { }
					})
				}else{
					$("#botaoSalvar").empty();
					$('#solicitanteMigracao').empty();
					$('#afetadoMigracao').empty();
				}
		}

		
		function salvarMigracao(){
			var idSolicitacao = $("#idModalMigracao").text();
			var idCliente = $("#nomeClienteMigracao").val();
			var solicitante = $("#solicitanteMigracao").val();
			var afetado = $("#afetadoMigracao").val();
			
			$.ajax({
				type: "PUT",
				contentType: "application/json",
				url: "/sistech/solicitacao/migracao",
				data: JSON.stringify({
					"idSolicitacao": idSolicitacao,
					"idCliente": idCliente,
					"solicitante": solicitante,
					"afetado": afetado
				}),
				success: function (data) {
									
					var modal = "",
						tempo,
						alerta,
						status ="";
					if(data.status != "FINALIZADO"){
						modal = "data-bs-target='#edicaoModalNaoFinalizado' onclick=editarNaoFinalizada(";
					}
					else{
						modal = "data-bs-target='#edicaoModal' onclick=editar(";
					}
					
					if(data.duracao != null){
						if(data.duracao <= 240 ){ alerta = "style='color: green; font-size: 19px'" ; tempo = data.duracao;}
						if(data.duracao > 240 && data.duracao < 420){ alerta = "style='color: Chocolate; font-size: 19px'" ; tempo = data.duracao;}
						if(data.duracao > 420){  alerta = "style='color: red; font-size: 19px'" ; tempo = data.duracao;}
					}else {tempo = " " ; alerta = " "}
					
						$('#linha' + data.id).remove();
						$('#exampleModal').modal('hide');
						alert("atualizado com sucesso");
						
						if(data.status == "ABERTO"){ status = "class='table-danger'" }
						if(data.status == "AGENDADO"){ status = "class='table-warning'"; dataAgendado = data.dataAgendado; }
						if(data.status == "ANDAMENTO"){ status = "class='table-info'" }
						if(data.status == "AGUARDANDO"){ status = "class='table-secondary'" }
						if(data.status == "PAUSADO"){ status = "class='table-light'" }
						if(data.status == "FINALIZADO"){ status = "class='table-success'" }
						var itens =
						'<tr '+ status + ' id=linha' + data.id + ' data-bs-toggle="modal" '+ modal + data.id + ')>'
						+ '<td id=name' + data.id + '>' + data.id + '</td>'
						+ '<td>' + data.dataAbertura + '</td>'
						+ '<td>' + data.nomeCliente + '</td>'
						+ '<td>' + data.solicitante + '</td>'
						+ '<td>' + data.afetado + '</td>'
						+ '<td style="font-size: 12px;"><p> Local: ' + data.local + '</p><p> Categoria: ' + data.categoria +'</p>' + '</td>'
						+ '<td>' + data.descricao + '</td>'
						+ '<td>' + data.prioridade + '</td>'
						+ '<td>' + data.classificacao + '</td>'
						+ '<td>' + data.nomeFuncionario + '</td>'
						+ '<td>' + data.status + '</td>'
						+ '<td '+ alerta +'><b>' + data.duracao + '</b></td>'
						+ '<td>' + data.versao + '</td>'
						+ '</tr>'
						$('#linha' + data.id).remove();
						$('#tabela-solicitacoes').append(itens);
						$('#modalMigrarSolicitacao').modal('hide');
						preencheBotoesTabela();
				},
				statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); },
					405: function() { alert('Você não possui permissão de edição!'); }
				}
			});
			
		}
		
		function migrarSolicitacao(){
			
			var id = $('#idModalEdicaoModalEdicao').text();
			$('#idModalMigracao').text("");
			$('#idModalMigracao').text(id);
			
			var nomeCliente = $('#nomeClienteModalFinalizado').text();
			$.ajax({
				type: "GET",
				contentType: "application/json",
				url: "/sistech/solicitacao/getData",
				success: function (data) {
					
					if(data.refeicao != true){
						$('#nomeClienteMigracao').empty();
						$('#nomeClienteMigracao').append('<option value="' + id + '">' + nomeCliente + '</option>');
						for (var i = 0; i < data.clientes.length; i++) {
							$('#nomeClienteMigracao').append('<option value="' + data.clientesId[i] + '">' + data.clientes[i] + '</option>');
						}
						$('#solicitanteMigracao').empty();
						$('#afetadoMigracao').empty();
						$('#solicitanteMigracao').append('<option value="Suporte" slected="selected">Suporte</option>');
						$('#solicitanteMigracao').append('<option value="Geral" slected="selected">Geral</option>');
						$('#afetadoMigracao').append('<option value="Suporte" slected="selected">Suporte</option>');
						$('#afetadoMigracao').append('<option value="Geral" slected="selected">Geral</option>');
					}else {
						alert("Seu status está Offline, modifique para Online para atendimento!");
					}
				},
				statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
					401: function() { 
						alert('Realize login novamente!'); 
						window.location.href = "/sistech/login"; 
					}
				}
			});
		}
		
		
		
		function exibeTimesheet(id){
			$('#tabela-timesheet-corpo').empty();			
			$.ajax({
				type: "GET",
				contentType: "application/json",
				url: "/sistech/api/v1/timesheet/"+id,
				success: function (data) {
					
					data.content.map(i => {
						var itens = 
						'<tr id=linha' + i.id + '>'
						+ '<td id=name' + i.id + '>' + i.id + '</td>'
						+ '<td>' + i.nomeFuncionario + '</td>'
						+ '<td>' + i.inicio + '</td>'
						+ '<td>' + i.fim + '</td>'
						+ '<td>' + i.duracao + '</td>'
						+ '<td>' + i.status + '</td>'
						+ '</tr>'
						$('#tabela-timesheet').append(itens);
						}
					);
				},
				statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); }
				}
			});
		}
		preencheBotoesTabela();
		
		var input = document.getElementById("palavraChave");
		input.addEventListener("keypress", function(event) {
		  if (event.key === "Enter") {
		    buscaPorPalavra();
		  }
		});
		
		
		function print() {
			var idFinalizado= $('#idModalEdicaoModalEdicao').text();
			var idNaoFinalizado= $('#idModalNaoFinalizado').text();
			
			if(idFinalizado != " "){
				 window.open('../impressao?id='+idFinalizado, '_blank');
			}else{
				 window.open('../impressao?id='+idNaoFinalizado, '_blank');
			}
      	}
		
		function cancelar(){
			if (confirm("Tem certeza que deseja cancelar a solicitação ?") == true) {
				var id,
					modal;
				if($('#idModalEdicaoModalEdicao').text() != " "){
					id = $('#idModalEdicaoModalEdicao').text();
					modal = "#edicaoModal";
				}else{
					id = $('#idModalNaoFinalizado').text();
					modal = "#edicaoModalNaoFinalizado";
				}
				var t = "#linha" + id;
				var remove = $(t).closest('tr');
				$.ajax({
					type: "PUT",
					contentType: "application/json",
					url: "/sistech/solicitacao/cancelar/" + id,
					success: function () {
						remove.fadeOut(800, function () {
							remove.remove();
						});
						$(modal).modal('hide');
					},
					error: function (e) { alert("Erro: Não foi possivel cancelar a solicitação!"); }
				});
			}
		}
		
		function exibeHistoricoNaoFinalizado(){
			var id = $('#idHistoricoModalEdicaoNaoFinalizado').text();
			$('#log').val("");
			$.ajax({
			type: "GET",
			contentType: "application/json",
			url: "/sistech/log/"+id,
			success: function (data) {
				$('#log').val(data);
			},
			statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); }
				}
			});
		}
		function exibeHistoricoFinalizado(){
			
			var id = $('#idHistoricoModalEdicao').text();
			$('#log').val("");
			$.ajax({
			type: "GET",
			contentType: "application/json",
			url: "/sistech/log/"+id,
			success: function (data) {
				$('#log').val(data);
			},
			statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); }
				}
			});
		} 
		
		function preencheBotoesTabela(){
				$.ajax({
				type: "GET",
				contentType: "application/json",
				url: "/sistech/solicitacao/relatorio",
				success: function (data) {
					$('#btnAbertosHoje').text(data.abertosHoje);
					$('#btnFinalizadosHoje').text(data.finalizadosHoje);
					$('#btnAtualizadosHoje').text(data.atualizadosHoje);
					$('#btnAgendadosHoje').text(data.agendadosHoje);
					$('#btnAtrasadosHoje').text(data.agendadosAtrasados);
	
					for (var i = 0; i < data.relatorioFuncionario.length; i++) {
						var itens = '<tr>'
						+ '<td>'+data.relatorioFuncionario[i].nome+'</td>'
						+ '<td>'+data.relatorioFuncionario[i].aberto+'</td>'
						+ '<td>'+data.relatorioFuncionario[i].andamento+'</td>'
						+ '<td>'+data.relatorioFuncionario[i].agendado+'</td>/'
						+ '<td>'+data.relatorioFuncionario[i].aguardando+'</td>'
						+ '<td>'+data.relatorioFuncionario[i].pausado+'</td>'
						+ '<td>'+data.relatorioFuncionario[i].total+'</td>'
						+ '</tr>'
						$('#tabela-resultados').append(itens);
					}
				},
				statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); }
				}
			});	
		}	
		
		function abertoHoje(){
			$('#corpoSolicitacoes').empty();
			
			let abertoHoje = document.getElementById('abertoHoje');
			let finalizadoHoje = document.getElementById('finalizadoHoje');
			let atualizadoHoje = document.getElementById('atualizadoHoje');
			let agendadoHoje = document.getElementById('agendadoHoje');
			let atrasadas = document.getElementById('atrasadas');

			atualizadoHoje.classList.remove('btn-danger');
			finalizadoHoje.classList.remove('btn-danger');
			agendadoHoje.classList.remove('btn-danger');
			finalizadoHoje.classList.remove('btn-danger');
			atrasadas.classList.remove('btn-danger');
			
			abertoHoje.classList.add('btn-danger');
			atualizadoHoje.classList.add('btn-sucess');
			agendadoHoje.classList.add('btn-sucess');
			finalizadoHoje.classList.add('btn-sucess');
			atrasadas.classList.add('btn-sucess');
			
			$.ajax({
				type: "GET",
				contentType: "application/json",
				url: "/sistech/solicitacao/relatorio/abertas/hoje",
				success: function (data) {
					var linkPage = document.getElementById('linkPage').value;
					linkPage = "/sistech/solicitacao/relatorio/abertas/hoje";
					document.getElementById('linkPage').value = linkPage;
					constroiResultados(data);
				},
				statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); }
				}
			});
		}
		
		function atualizadoHoje(){
			$('#corpoSolicitacoes').empty();
			
			let abertoHoje = document.getElementById('abertoHoje');
			let finalizadoHoje = document.getElementById('finalizadoHoje');
			let atualizadoHoje = document.getElementById('atualizadoHoje');
			let agendadoHoje = document.getElementById('agendadoHoje');
			let atrasadas = document.getElementById('atrasadas');

			abertoHoje.classList.remove('btn-danger');
			finalizadoHoje.classList.remove('btn-danger');
			agendadoHoje.classList.remove('btn-danger');
			finalizadoHoje.classList.remove('btn-danger');
			atrasadas.classList.remove('btn-danger');
			
			abertoHoje.classList.add('btn-sucess');
			atualizadoHoje.classList.add('btn-danger');
			agendadoHoje.classList.add('btn-sucess');
			finalizadoHoje.classList.add('btn-sucess');
			atrasadas.classList.add('btn-sucess');
			
			$.ajax({
				type: "GET",
				contentType: "application/json",
				url: "/sistech/solicitacao/relatorio/atualizadas/hoje",
				success: function (data) {
					var linkPage = document.getElementById('linkPage').value;
					linkPage = "/sistech/solicitacao/relatorio/atualizadas/hoje";
					document.getElementById('linkPage').value = linkPage;
					constroiResultados(data);
				},
				statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); }
				}
			});
		}
		
		function finalizadoHoje(){
			$('#corpoSolicitacoes').empty();
			
			let abertoHoje = document.getElementById('abertoHoje');
			let finalizadoHoje = document.getElementById('finalizadoHoje');
			let atualizadoHoje = document.getElementById('atualizadoHoje');
			let agendadoHoje = document.getElementById('agendadoHoje');
			let atrasadas = document.getElementById('atrasadas');

			abertoHoje.classList.remove('btn-danger');
			atualizadoHoje.classList.remove('btn-danger');
			agendadoHoje.classList.remove('btn-danger');
			finalizadoHoje.classList.remove('btn-danger');
			atrasadas.classList.remove('btn-danger');
			
			abertoHoje.classList.add('btn-sucess');
			atualizadoHoje.classList.add('btn-sucess');
			agendadoHoje.classList.add('btn-sucess');
			finalizadoHoje.classList.add('btn-danger');
			atrasadas.classList.add('btn-sucess');
			
			$.ajax({
				type: "GET",
				contentType: "application/json",
				url: "/sistech/solicitacao/relatorio/finalizadas/hoje",
				success: function (data) {
					var linkPage = document.getElementById('linkPage').value;
					linkPage = "/sistech/solicitacao/relatorio/finalizadas/hoje";
					document.getElementById('linkPage').value = linkPage;
					constroiResultados(data);
				},
				statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); }
				}
			});
		}
		
		function agendadoHoje(){
			$('#corpoSolicitacoes').empty();
			
			let abertoHoje = document.getElementById('abertoHoje');
			let finalizadoHoje = document.getElementById('finalizadoHoje');
			let atualizadoHoje = document.getElementById('atualizadoHoje');
			let agendadoHoje = document.getElementById('agendadoHoje');
			let atrasadas = document.getElementById('atrasadas');
			
			agendadoHoje.classList.remove('btn-danger');
			abertoHoje.classList.remove('btn-danger');
			atualizadoHoje.classList.remove('btn-danger');
			finalizadoHoje.classList.remove('btn-danger');
			atrasadas.classList.remove('btn-danger');
			
			abertoHoje.classList.add('btn-sucess');
			atualizadoHoje.classList.add('btn-sucess');
			agendadoHoje.classList.add('btn-danger');
			finalizadoHoje.classList.add('btn-sucess');
			atrasadas.classList.add('btn-sucess');
			
			$.ajax({
				type: "GET",
				contentType: "application/json",
				url: "/sistech/solicitacao/relatorio/agendadas/hoje",
				success: function (data) {
					var linkPage = document.getElementById('linkPage').value;
					linkPage = "/sistech/solicitacao/relatorio/agendadas/hoje";
					document.getElementById('linkPage').value = linkPage;
					constroiResultados(data);
				},
				statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); }
				}
			});
		}
		
		function atrasadas(){
			$('#corpoSolicitacoes').empty();
			
			let abertoHoje = document.getElementById('abertoHoje');
			let finalizadoHoje = document.getElementById('finalizadoHoje');
			let atualizadoHoje = document.getElementById('atualizadoHoje');
			let agendadoHoje = document.getElementById('agendadoHoje');
			let atrasadas = document.getElementById('atrasadas');

			abertoHoje.classList.remove('btn-danger');
			atualizadoHoje.classList.remove('btn-danger');
			finalizadoHoje.classList.remove('btn-danger');
			agendadoHoje.classList.remove('btn-danger');
			
			abertoHoje.classList.add('btn-sucess');
			atualizadoHoje.classList.add('btn-sucess');
			agendadoHoje.classList.add('btn-sucess');
			finalizadoHoje.classList.add('btn-sucess');
			atrasadas.classList.add('btn-danger');
			
			$.ajax({
				type: "GET",
				contentType: "application/json",
				url: "/sistech/solicitacao/relatorio/atrasadas/hoje",
				success: function (data) {
					var linkPage = document.getElementById('linkPage').value;
					linkPage = "/sistech/solicitacao/relatorio/atrasadas/hoje";
					document.getElementById('linkPage').value = linkPage;
					constroiResultados(data);
				},
				statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); }
				}
			});
		}
		
		
		function buscaPorPalavra(){
					
			$('#corpoSolicitacoes').empty();
			let palavra = document.getElementById('palavraChave').value;
			
			if(palavra != ''){
				$.ajax({
					type: "GET",
					contentType: "application/json",
					url: "/sistech/solicitacao/palavra/"+palavra,
					success: function (data) {
						$('#totalElementos').text("");
						$('#totalElementos').text(data.totalElements);
						var linkPage = document.getElementById('linkPage').value;
						linkPage = "/sistech/solicitacao/palavra/"+palavra;
						document.getElementById('linkPage').value = linkPage;
						constroiResultados(data);
					},
					statusCode: {
					    500: function() { alert('Erro! Contate o desenvolvedor!'); },
					    401: function() { alert('Realize login novamente!'); }
					}
				});
			}else{alert("Preencha com uma palavra");}
		}
		
		function constroiResultados(data){
				document.getElementById('tabela-resultados').style.display = 'none';
				document.getElementById('tabela-solicitacoes').style.display = 'none';
				$("#tabela-solicitacoes").stop().slideToggle(300);	
				$('#paginas').empty();
				
				if(data.totalPages > 1){
					for(var i=0; i < data.totalPages ; i++ ){
						$('#paginas').append('<li class="page-item" id=numPag'+ i+'"><a id=numPag'+ i+' class="page-link" onclick="paginacao('+ i +')">'+ (i + 1) +'</a></li>');
					}
					$("#numPag0").attr("style","color:red");
				}
			
				data.content.map(i => {
					var tempo=0,
						dataStatus =" ";
					if(i.status == "ABERTO"){ status = "class='table-danger'"; dataStatus = " " }
					if(i.status == "AGENDADO"){ status = "class='table-warning'"; dataStatus = i.dataAgendado; }
					if(i.status == "ANDAMENTO"){ status = "class='table-primary'"; dataStatus = i.dataAndamento;  }
					if(i.status == "AGUARDANDO"){ status = "class='table-secondary'"; dataStatus = " "  }
					if(i.status == "PAUSADO"){ status = "class='table-light'"; dataStatus = " "  }
					if(i.status == "FINALIZADO"){ status = "class='table-success'"; dataStatus = " "  }
					var modal;
					if(i.status != "FINALIZADO"){
						modal = "data-bs-toggle='modal' data-bs-target='#edicaoModalNaoFinalizado' onclick=editarNaoFinalizada(";
					}
					else{
						modal = "data-bs-toggle='modal' data-bs-target='#edicaoModal' onclick=editar(";
					}
					
					if(i.duracao != null){
						if(i.duracao <= 240 ){ alerta = "style='color: green; font-size: 19px'" ; tempo = i.duracao;}
						if(i.duracao > 240 && i.duracao < 420){ alerta = "style='color: Chocolate; font-size: 19px'" ; tempo = i.duracao;}
						if(i.duracao > 420){  alerta = "style='color: red; font-size: 19px'" ; tempo = i.duracao;}
					}else {tempo = " "; alerta = " "}
					var itens = 
					'<tr '+ status + ' id=linha' + i.id+' ' + modal + i.id + ')>'
					+ '<td id=name' + i.id + '>' + i.id + '</td>'
					+ '<td>' + i.dataAbertura + '</td>'
					+ '<td>' + i.nomeCliente + '</td>'
					+ '<td>' + i.solicitante + '</td>'
					+ '<td>' + i.afetado + '</td>'
					+ '<td style="font-size: 12px;"><p> Local: ' + i.local + '</p>Categoria: ' + i.categoria +'</td>'
					+ '<td>' + i.descricao + '</td>'
					+ '<td>' + i.prioridade + '</td>'
					+ '<td>' + i.classificacao + '</td>'
					+ '<td>' + i.nomeFuncionario + '</td>'
					+ '<td><p>' + i.status + '<b></p><span style="font-size: 13px; color: red">' + dataStatus + '</span></b></td>'
					+ '<td '+ alerta +'><b>' + tempo + '</b></td>'
					+ '<td>' + i.versao + '</td>'
					+ '</tr>'
					$('#corpoSolicitacoes').append(itens);
					}
				);
		}
		
		function baixaCsv(){
			let dataInicio = document.getElementById('relatorioDataInicio').value;
			let dataFim = document.getElementById('relatorioDataFim').value;
			
			if(dataInicio != '' && dataFim != ''){
				$.ajax({
					type: "GET",
					contentType: "application/json",
					url: "/sistech/api/csv/relatorio/periodo/inicio/"+dataInicio+"/fim/"+dataFim,
					success: function (data) {
						var csvContent = "data:text/csv;charset=utf-8," + data;
	    				window.open(csvContent);
					},
					error: function (e) { alert(e); }
				});
			}else{
				alert("Selecione data de inicio e data de término");
			}
				
		}
		
		function paginacao(num){
			var linkPage = document.getElementById('linkPage').value;
			
			$.ajax({
			type: "GET",
			contentType: "application/json",
			url: linkPage+"?page="+num,
			success: function (data) {
					$('#corpoSolicitacoes').empty();
					var linkPage = document.getElementById('linkPage').value;
					document.getElementById('linkPage').value = linkPage;
					constroiResultados(data);
			},
			statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); }
				}
			});
		}
		
		function editar(id) {
			$.ajax({
				type: "GET",
				contentType: "application/json",
				url: "/sistech/solicitacao/relatorio/editar/" + id,
				success: function (data) {
					
					if(data.funcionarios != null && data.colaboradores != null){
						
						$('#btnTimesheet').text("");
						if(data.duracao > 0){
							$('#btnTimesheet').append('<button class="btn btn-sm btn-timesheet" data-bs-toggle="modal" data-bs-target="#modalTimesheetSolicitacao" onclick="exibeTimesheet('+ id +')"><i class="bi bi-clock-history"></i></button>');
						}
						
						$('#nomeClienteModalFinalizado').text("");
						$('#nomeClienteModalFinalizado').text(data.nomeCliente);
						
						$('#idHistoricoModalEdicao').text("");
						$('#idModalEdicaoModalEdicao').text("");
						$('#dataAtualizacaoModalEdicao').empty();
						$('#descricaomodal').val("");
						$('#resolucaomodal').val("");
						$('#observacaomodal').val("");
						$('#duracaoModalEdicao').text("");
						$('#categoriamodal').empty();
						$('#classificacaomodal').empty();
						$('#prioridademodal').empty();
						$('#localmodal').empty();
						$('#dataAberturaModalEdicao').val("");
						$('#horaAberturaModalEdicao').val("");
						$('#dataAndamentoModalEdicao').val("");
						$('#horaAndamentoModalEdicao').val("");
						$('#dataFinalizadoModalEdicao').val("");
						$('#dataFinalizadoModalEdicao').val("");
						$('#formaaberturamodal').empty();
						$('#nomefuncionariomodal').empty();
						$('#solicitantemodal').empty();
						$('#afetadomodal').empty();
						
						$('#idHistoricoModalEdicao').text(data.log_id);
						$('#dataAberturaModalEdicao').val(data.dataAbertura);
						$('#horaAberturaModalEdicao').val(data.horaAbertura);
						$('#dataAndamentoModalEdicao').val(data.dataAndamento);
						$('#horaAndamentoModalEdicao').val(data.horaAndamento);
						$('#dataFinalizadoModalEdicao').val(data.dataFinalizado);
						$('#horaFinalizadoModalEdicao').val(data.horaFinalizado);
						$('#dataAtualizacaoModalEdicao').append('<span style="font-size: 14px"> <i class="bi bi-person-plus"></i> Aberto por: ' + data.abertoPor + '&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <i class="bi bi-calendar3"></i> Atualizado em: ' + data.dataAtualizacao+'</span>');
						$('#idModalEdicaoModalEdicao').text(data.id);
						$('#descricaomodal').val(data.descricao);
						$('#resolucaomodal').val(data.resolucao);
						$('#observacaomodal').val(data.observacao);
						
						$('#solicitantemodal').append('<option value="' + data.solicitante + '">' + data.solicitante + '</option>');
						for (var i = 0; i < data.colaboradores.length; i++) {
							$('#solicitantemodal').append('<option value="' + data.colaboradores[i] + '">' + data.colaboradores[i] + '</option>');
						}
						$('#solicitantemodal').append('<option value="Suporte"> Suporte</option>');
						$('#solicitantemodal').append('<option value="Geral"> Geral</option>');
						
						$('#afetadomodal').append('<option value="' + data.afetado + '">' + data.afetado	 + '</option>');
						for (var i = 0; i < data.colaboradores.length; i++) {
							$('#afetadomodal').append('<option value="' + data.colaboradores[i] + '">' + data.colaboradores[i] + '</option>');
						}
						$('#afetadomodal').append('<option value="Suporte"> Suporte</option>');
						$('#afetadomodal').append('<option value="Geral"> Geral</option>');
	
						$('#nomefuncionariomodal').append('<option value="' + data.nomeFuncionario + '">' + data.nomeFuncionario + '</option>');
						for (var i = 0; i < data.funcionarios.length; i++) {
							$('#nomefuncionariomodal').append('<option value="' + data.funcionarios[i] + '">' + data.funcionarios[i] + '</option>');
						}
						
						if(data.duracao <= 60){ $('#duracaoModalEdicao').text(data.duracao + " minutos"); }
						else{ $('#duracaoModalEdicao').text(  Math.round(data.duracao / 60)   + " horas"); }
						
						$('#formaaberturamodal').append("<option value="+ data.formaAbertura +">"+ data.formaAbertura+"</option>"
							+'<option value="TELEFONE">TELEFONE</option>'
							+'<option value="EMAIL">EMAIL</option>'
							+'<option value="WHATSAPP">WHATSAPP</option>'
							+'<option value="LOCAL">NO LOCAL</option>'
							+'<option value="PROATIVO">PROATIVO</option>');
						
						$('#categoriamodal').append("<option value="+ data.categoria +">"+ data.categoria+"</option>"
						+'<option value="SOFTWARE">SOFTWARE</option>'
						+'<option value="HARDWARE">HARDWARE</option>'
						+'<option value="EMAIL">EMAIL</option>'
						+'<option value="SHAREPOINT">SHAREPOINT</option>'
						+'<option value="INTERNET">INTERNET</option>'
						+'<option value="SERVIDORES">SERVIDORES</option>'
						+'<option value="OUTROS">OUTROS</option>'
						+'<option value="REDE">REDE</option>'
						+'<option value="CABEAMENTO">CABEAMENTO</option>'
						+'<option value="SMARTPHONE">SMARTPHONE</option>'
						+'<option value="PROJETO">PROJETO</option>'
						+'<option value="BACKUP">BACKUP</option>'
						+'<option value="COTACAO">COTAÇÃO</option>'
						+'<option value="MIGRACAO">MIGRAÇÃO</option>'
						+'<option value="DOMINIOS">DOMÍNIOS</option>'
						+'<option value="HOSPEDAGENS">HOSPEDAGENS</option>');
						$('#classificacaomodal').append("<option value="+ data.classificacao +">"+ data.classificacao+"</option>"
							+'<option value="INCIDENTE">INCIDENTE</option>'
							+'<option value="PROBLEMA">PROBLEMA</option>'
							+'<option value="SOLICITACAO">SOLICITACAO</option>'
							+'<option value="ACESSO">ACESSO</option>'
							+'<option value="EVENTO">EVENTO</option>'
							+'<option value="BACKUP">BACKUP</option>');
							
						$('#prioridademodal').append("<option value="+ data.prioridade +">"+ data.prioridade+"</option>"
							+'<option value="BAIXA">BAIXA</option>'
							+'<option value="MEDIA">MEDIA</option>'
							+'<option value="ALTA">ALTA</option>'
							+'<option value="CRITICA">CRITICA</option>'
							+'<option value="PLANEJADA">PLANEJADA</option>');
							
						$('#localmodal').append("<option value="+ data.local +">"+ data.local+"</option>"
							+'<option value="ONSITE">ONSITE</option>'
							+'<option value="OFFSITE">OFFSITE</option>');
	
						if (data.status == 'FINALIZADO') {
							$('#statusModalEdicao').append("<option value=" + data.status + ">" + data.status + "</option>");
						}  
					}else{
						alert("Seu status está Offline, modifique para Online para atendimento!");
					}

					
				},
				statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); }
				}
			});
		}
		
		function atualiza() {
			var id = $('#idModalEdicaoModalEdicao').text(),
				descricao = $('#descricaomodal').val(),
				resolucao = $('#resolucaomodal').val(),
				observacao = $('#observacaomodal').val(),
				status = $('#statusmodal').val(),
				categoria = $('#categoriamodal').val(),
				classificacao = $('#classificacaomodal').val(),
				prioridade = $('#prioridademodal').val(),
				local = $('#localmodal').val(),
				nomeFuncionario = $('#nomefuncionariomodal').val(),
				dataAbertura = $('#dataAberturaModalEdicao').val(),
				horaAbertura = $('#horaAberturaModalEdicao').val(),
				dataAndamento = $('#dataAndamentoModalEdicao').val(),
				horaAndamento = $('#horaAndamentoModalEdicao').val(),
				dataFinalizado = $('#dataFinalizadoModalEdicao').val(),
				horaFinalizado = $('#horaFinalizadoModalEdicao').val(),
				formaAbertura = $('#formaaberturamodal').val(),
				solicitante = $('#solicitantemodal').val(),
				afetado = $('#afetadomodal').val();
			
			$.ajax({
				type: "PUT",
				contentType: "application/json",
				url: "/sistech/solicitacao/finalizada/atualizar",
				data: JSON.stringify({
					"id": id,
					"descricao": descricao,
					"resolucao": resolucao,
					"observacao": observacao,
					"status": status,
					"categoria": categoria,
					"classificacao": classificacao,
					"prioridade": prioridade,
					"local": local,
					"nomeFuncionario": nomeFuncionario,
					"dataAbertura": dataAbertura,
					"horaAbertura": horaAbertura,
					"dataAndamento": dataAndamento,
					"horaAndamento": horaAndamento,
					"dataFinalizado": dataFinalizado,
					"horaFinalizado": horaFinalizado,
					"formaAbertura": formaAbertura,
					"solicitante": solicitante,
					"afetado": afetado 
				}),
				success: function (data) {
					var alerta = "";
					var tempo=0;
					if(data.duracao != null){
						if(data.duracao <= 240 ){ alerta = "style='color: green; font-size: 19px'" ; tempo = data.duracao;}
						if(data.duracao > 240 && data.duracao < 420){ alerta = "style='color: Chocolate; font-size: 19px'" ; tempo = data.duracao;}
						if(data.duracao > 420){  alerta = "style='color: red; font-size: 19px'" ; tempo = data.duracao;}
					}else {tempo = " " ; alerta = " "}
					
					var modal = "";
					if(data.status != "FINALIZADO"){
						modal = "data-bs-target='#edicaoModalNaoFinalizado' onclick=editarNaoFinalizada(";
					}
					else{
						modal = "data-bs-target='#edicaoModal' onclick=editar(";
					}
						$('#linha' + data.id).remove();
						$('#exampleModal').modal('hide');
						alert("atualizado com sucesso");
						
						var status;
						if(data.status == "ABERTO"){ status = "class='table-danger'" }
						if(data.status == "AGENDADO"){ status = "class='table-warning'"; dataAgendado = data.dataAgendado; }
						if(data.status == "ANDAMENTO"){ status = "class='table-info'" }
						if(data.status == "AGUARDANDO"){ status = "class='table-secondary'" }
						if(data.status == "PAUSADO"){ status = "class='table-light'" }
						if(data.status == "FINALIZADO"){ status = "class='table-success'" }
						
						var itens =
						'<tr '+ status + ' id=linha' + data.id + ' data-bs-toggle="modal" '+ modal + data.id + ')>'
						+ '<td id=name' + data.id + '>' + data.id + '</td>'
						+ '<td>' + data.dataAbertura + '</td>'
						+ '<td>' + data.nomeCliente + '</td>'
						+ '<td>' + data.solicitante + '</td>'
						+ '<td>' + data.afetado + '</td>'
						+ '<td style="font-size: 12px;"><p> Local: ' + data.local + '</p> Categoria: ' + data.categoria +'</td>'
						+ '<td>' + data.descricao + '</td>'
						+ '<td>' + data.prioridade + '</td>'
						+ '<td>' + data.classificacao + '</td>'
						+ '<td>' + data.nomeFuncionario + '</td>'
						+ '<td>' + data.status + '</td>'
						+ '<td '+ alerta +'><b>' + data.duracao + '</b></td>'
						+ '<td>' + data.versao + '</td>'
						+ '</tr>'
						$('#linha' + data.id).remove();
						$('#tabela-solicitacoes').append(itens);
						$('#edicaoModal').modal('hide');
						preencheBotoesTabela();
				},
				statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); }
				}
			});
		}
		
		function verificar(id) {
			$.ajax({
				type: "GET",
				contentType: "application/json",
				url: "/sistech/solicitacao/relatorio/" + id,
				success: function (data) {
					
					var minutos = data.duracao;
					if(minutos > 60){
						$('#duracaoModal').text("");
						$('#duracaoModal').text(Math.round(data.duracao / 60) + " horas");
					} else{
						$('#duracaoModal').text("");
						$('#duracaoModal').text(data.duracao + " minutos");
					}
					
					$('#edicaoModalBotao').empty();
					
					if(data.status != "FINALIZADO"){
						$('#edicaoModalBotao').append("<button class='btn btn-primary btn-sm ' id='edicao' data-bs-toggle='modal' data-bs-target='#edicaoModalNaoFinalizado' onclick=editarNaoFinalizada(" + data.id + ")> Editar</button>");
					}
					else{
						$('#edicaoModalBotao').append("<button class='btn btn-primary btn-sm ' id='edicao' data-bs-toggle='modal' data-bs-target='#edicaoModal' onclick=editar(" + data.id + ")> Editar</button>");
					}
					
					$('#nomeClienteModal').text("");
					$('#dataAberturaModal').text("");
					$('#solicitanteModal').text("");
					$('#afetadoModal').text("");
					$('#descricaoModal').text("");
					$('#observacaoModal').text("");
					$('#categoriaModal').text("");
					$('#classificacaoModal').text("");
					$('#localModal').text("");
					$('#resolucaoModal').text("");
					$('#nomeFuncionarioModal').text("");
					$('#prioridadeModal').text("");
					$('#abertoPorModal').text("");
					
					$('#nomeClienteModal').text(data.nomeCliente);
					$('#dataAberturaModal').text(data.dataAbertura);
					$('#solicitanteModal').text(data.solicitante);
					$('#afetadoModal').text(data.afetado);
					$('#descricaoModal').text(data.descricao);
					$('#observacaoModal').text(data.observacao);
					$('#categoriaModal').text(data.categoria);
					$('#classificacaoModal').text(data.classificacao);
					$('#localModal').text(data.local);
					$('#resolucaoModal').text(data.resolucao);
					$('#nomeFuncionarioModal').text(data.nomeFuncionario);
					$('#prioridadeModal').text(data.prioridade);
					$('#abertoPorModal').text(data.abertoPor);
				},
				statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); }
				}
			});
		}
		
		function editarNaoFinalizada(id) {
			$.ajax({
				type: "GET",
				contentType: "application/json",
				url: "/sistech/solicitacao/busca/" + id,
				success: function (data) {
					
					if(data.funcionarios != null && data.colaboradores != null){
						
						$('#btnTimesheetNaoFinalizado').text("");
						if(data.duracao > 0){
							$('#btnTimesheetNaoFinalizado').append('<button class="btn btn-link" data-bs-toggle="modal" data-bs-target="#modalTimesheetSolicitacao" onclick="exibeTimesheet('+ id +')"><i class="bi bi-clock-history"></i></button>');
						}

						$('#idHistoricoModalEdicaoNaoFinalizado').text("");
						$('#idModalNaoFinalizado').text("");
						$('#dataAtualizacaoModalNaoFinalizado').empty();
						$('#descricaoModalNaoFinalizado').val("");
						$('#resolucaoModalNaoFinalizado').val("");
						$('#observacaoModalNaoFinalizado').val("");
						$('#statusModalNaoFinalizado').empty();
						$('#categoriaModalNaoFinalizado').empty();
						$('#classificacaoModalNaoFinalizado').empty();
						$('#prioridadeModalNaoFinalizado').empty();
						$('#localModalNaoFinalizado').empty();
						$('#nomeFuncionarioModalNaoFinalizado').empty();
						$('#nomeSolicitanteModalNaoFinalizado').empty();
						$('#nomeAfetadoModalNaoFinalizado').empty();
						$('#dataModalNaoFinalizado').val("");
						$('#horaModalNaoFinalizado').val("");
						$('#formaAberturaModalNaoFinalizado').empty();
						$('#id_cliente').text("");
	
						$('#idHistoricoModalEdicaoNaoFinalizado').text(data.log_id);
						$('#id_cliente').text(data.clienteId);
						$('#idModalNaoFinalizado').text(data.id);
						$('#dataAtualizacaoModalNaoFinalizado').append('<span style="font-size: 14px"> <i class="bi bi-person-plus"></i> Aberto por: ' + data.abertoPor + '&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <i class="bi bi-calendar3"></i> Atualizado em: ' + data.dataAtualizacao+'</span>');
						$('#descricaoModalNaoFinalizado').val(data.descricao);
						$('#resolucaoModalNaoFinalizado').val(data.resolucao);
						$('#observacaoModalNaoFinalizado').val(data.observacao);
						
						$('#nomeFuncionarioModalNaoFinalizado').append("<option value=" + data.funcionario + ">" + data.funcionario + "</option>");
						for (var i = 0; i < data.funcionarios.length; i++) {
							$('#nomeFuncionarioModalNaoFinalizado').append('<option value="' + data.funcionarios[i] + '">' + data.funcionarios[i] + '</option>');
						}
						
						$('#nomeSolicitanteModalNaoFinalizado').append('<option value="' + data.solicitante + '">' + data.solicitante + '</option>');
						for (var i = 0; i < data.colaboradores.length; i++) {
							$('#nomeSolicitanteModalNaoFinalizado').append('<option value="' + data.colaboradores[i] + '">' + data.colaboradores[i] + '</option>');
						}
						$('#nomeSolicitanteModalNaoFinalizado').append('<option value="Suporte"> Suporte</option>');
						$('#nomeSolicitanteModalNaoFinalizado').append('<option value="Geral"> Geral</option>');
						
						$('#nomeAfetadoModalNaoFinalizado').append('<option value="' + data.afetado + '">' + data.afetado	 + '</option>');
						for (var i = 0; i < data.colaboradores.length; i++) {
							$('#nomeAfetadoModalNaoFinalizado').append('<option value="' + data.colaboradores[i] + '">' + data.colaboradores[i] + '</option>');
						}
						$('#nomeAfetadoModalNaoFinalizado').append('<option value="Suporte"> Suporte</option>');
						$('#nomeAfetadoModalNaoFinalizado').append('<option value="Geral"> Geral</option>');
						
						$('#formaAberturaModalNaoFinalizado').append("<option value="+ data.formaAbertura +">"+ data.formaAbertura+"</option>"
							+'<option value="TELEFONE">TELEFONE</option>'
							+'<option value="EMAIL">EMAIL</option>'
							+'<option value="WHATSAPP">WHATSAPP</option>'
							+'<option value="LOCAL">NO LOCAL</option>'
							+'<option value="PROATIVO">PROATIVO</option>');
						
						$('#categoriaModalNaoFinalizado').append("<option value="+ data.categoria +">"+ data.categoria+"</option>"
						+'<option value="SOFTWARE">SOFTWARE</option>'
						+'<option value="HARDWARE">HARDWARE</option>'
						+'<option value="EMAIL">EMAIL</option>'
						+'<option value="SHAREPOINT">SHAREPOINT</option>'
						+'<option value="INTERNET">INTERNET</option>'
						+'<option value="SERVIDORES">SERVIDORES</option>'
						+'<option value="OUTROS">OUTROS</option>'
						+'<option value="REDE">REDE</option>'
						+'<option value="CABEAMENTO">CABEAMENTO</option>'
						+'<option value="SMARTPHONE">SMARTPHONE</option>'
						+'<option value="PROJETO">PROJETO</option>'
						+'<option value="BACKUP">BACKUP</option>'
						+'<option value="COTACAO">COTAÇÃO</option>'
						+'<option value="MIGRACAO">MIGRAÇÃO</option>'
						+'<option value="DOMINIOS">DOMÍNIOS</option>'
						+'<option value="HOSPEDAGENS">HOSPEDAGENS</option>');
						$('#classificacaoModalNaoFinalizado').append("<option value="+ data.classificacao +">"+ data.classificacao+"</option>"
							+'<option value="INCIDENTE">INCIDENTE</option>'
							+'<option value="PROBLEMA">PROBLEMA</option>'
							+'<option value="SOLICITACAO">SOLICITACAO</option>'
							+'<option value="ACESSO">ACESSO</option>'
							+'<option value="EVENTO">EVENTO</option>'
							+'<option value="BACKUP">BACKUP</option>');
							
						$('#prioridadeModalNaoFinalizado').append("<option value="+ data.prioridade +">"+ data.prioridade+"</option>"
							+'<option value="BAIXA">BAIXA</option>'
							+'<option value="MEDIA">MEDIA</option>'
							+'<option value="ALTA">ALTA</option>'
							+'<option value="CRITICA">CRITICA</option>'
							+'<option value="PLANEJADA">PLANEJADA</option>');
							
						$('#localModalNaoFinalizado').append("<option value="+ data.local +">"+ data.local+"</option>"
							+'<option value="ONSITE">ONSITE</option>'
							+'<option value="OFFSITE">OFFSITE</option>');
						
						if (data.status == 'ABERTO') {
							$('#statusModalNaoFinalizado').append("<option value=" + data.status + ">" + data.status + "</option>");
							$('#statusModalNaoFinalizado').append("<option value=ANDAMENTO>ANDAMENTO</option>");
							$('#statusModalNaoFinalizado').append("<option value=AGENDADO>AGENDADO</option>");
							$('#statusModalNaoFinalizado').append("<option value=AGUARDANDO>AGUARDANDO</option>");
							document.getElementById('agendamentosmodal').style.display = 'none';
						} if (data.status == 'ANDAMENTO') {
							$('#statusModalNaoFinalizado').append("<option value=" + data.status + ">" + data.status + "</option>");
							$('#statusModalNaoFinalizado').append("<option value=FINALIZADO>FINALIZADO</option>");
							$('#statusModalNaoFinalizado').append("<option value=PAUSADO>PAUSADO</option>");
							$('#statusModalNaoFinalizado').append("<option value=AGUARDANDO>AGUARDANDO</option>");
							$('#statusModalNaoFinalizado').append("<option value=AGENDADO>AGENDADO</option>");
							$('#statusModalNaoFinalizado').append("<option value=ABERTO>ABERTO</option>");
							document.getElementById('agendamentosmodal').style.display = 'none';
						} if (data.status == 'AGENDADO') {
							$('#statusModalNaoFinalizado').append("<option value=" + data.status + ">" + data.status + "</option>");
							$('#statusModalNaoFinalizado').append("<option value=ANDAMENTO>ANDAMENTO</option>");
							$('#statusModalNaoFinalizado').append("<option value=AGUARDANDO>AGUARDANDO</option>");
							$('#statusModalNaoFinalizado').append("<option value=ABERTO>ABERTO</option>");
							document.getElementById('agendamentosmodal').style.display = '';
							$('#dataModalNaoFinalizado').val(data.dataAgendado);
							$('#horaModalNaoFinalizado').val(data.horaAgendado);
						} if (data.status == 'AGUARDANDO') {
							$('#statusModalNaoFinalizado').append("<option value=" + data.status + ">" + data.status + "</option>");
							$('#statusModalNaoFinalizado').append("<option value=ANDAMENTO>ANDAMENTO</option>");
							$('#statusModalNaoFinalizado').append("<option value=ABERTO>ABERTO</option>");
							$('#statusModalNaoFinalizado').append("<option value=AGENDADO>AGENDADO</option>");
							document.getElementById('agendamentosmodal').style.display = 'none';
						} if (data.status == 'PAUSADO') {
							$('#statusModalNaoFinalizado').append("<option value=" + data.status + ">" + data.status + "</option>");
							$('#statusModalNaoFinalizado').append("<option value=ANDAMENTO>ANDAMENTO</option>");
							$('#statusModalNaoFinalizado').append("<option value=AGENDADO>AGENDADO</option>");
							$('#statusModalNaoFinalizado').append("<option value=ABERTO>ABERTO</option>");
							document.getElementById('agendamentosmodal').style.display = 'none';
						}
						
						$.ajax({
							type: "GET",
							contentType: "application/json",
							url: "/sistech/colaborador/list/cliente/"+ data.clienteId +"/"+ data.solicitante,
							success: function (data) {
								$('#celSolicitante').text(" ");
								if(data != null){
									$('#celSolicitante').text(data);
								}
							},
							statusCode: {
							    500: function() { alert('Erro! Contate o desenvolvedor!'); },
							    401: function() { alert('Realize login novamente!'); }
							}
						});
						
						var nomeAfetado = $("#afetado").val();
						$.ajax({
							type: "GET",
							contentType: "application/json",
							url: "/sistech/colaborador/list/cliente/"+ data.clienteId +"/"+ data.afetado,
							success: function (data) {
								$('#celAfetado').text(" ");
								if(data != null){
									$('#celAfetado').text(data);
								}
							},
							statusCode: {
							    500: function() { alert('Erro! Contate o desenvolvedor!'); },
							    401: function() { alert('Realize login novamente!'); }
							}
						});
					}else{
						alert("Seu status está Offline, modifique para Online para atendimento!");
					}
						
					
				},
				statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); }
				}
			});
		}
		
		function atualizaNaoFinalizado() {
			var id = $('#idModalNaoFinalizado').text(),
				descricao = $('#descricaoModalNaoFinalizado').val(),
				resolucao = $('#resolucaoModalNaoFinalizado').val(),
				observacao = $('#observacaoModalNaoFinalizado').val(),
				status = $('#statusModalNaoFinalizado').val(),
				categoria = $('#categoriaModalNaoFinalizado').val(),
				classificacao = $('#classificacaoModalNaoFinalizado').val(),
				prioridade = $('#prioridadeModalNaoFinalizado').val(),
				local = $('#localModalNaoFinalizado').val(),
				solicitante = $('#nomeSolicitanteModalNaoFinalizado').val(),
				afetado = $('#nomeAfetadoModalNaoFinalizado').val(),
				nomeFuncionario = $('#nomeFuncionarioModalNaoFinalizado').val(),
				dataAgendado = $('#dataModalNaoFinalizado').val(),
				horaAgendado = $('#horaModalNaoFinalizado').val(),
				formaAbertura = $('#formaAberturaModalNaoFinalizado').val();
		
			$.ajax({
				type: "PUT",
				contentType: "application/json",
				url: "/sistech/solicitacao/edicaoRapida",
				data: JSON.stringify({
					"id": id,
					"descricao": descricao,
					"resolucao": resolucao,
					"observacao": observacao,
					"status": status,
					"categoria": categoria,
					"classificacao": classificacao,
					"prioridade": prioridade,
					"local": local,
					"nomeFuncionario": nomeFuncionario,
					"solicitante": solicitante,
					"afetado": afetado,
					"dataAgendado": dataAgendado,
					"horaAgendado": horaAgendado,
					"formaAbertura": formaAbertura
				}),
				success: function (data) {
					
					var modal = "",
						tempo,
						alerta,
						status ="";
					if(data.status != "FINALIZADO"){
						modal = "data-bs-target='#edicaoModalNaoFinalizado' onclick=editarNaoFinalizada(";
					}
					else{
						modal = "data-bs-target='#edicaoModal' onclick=editar(";
					}
					
					if(data.duracao != null){
						if(data.duracao <= 240 ){ alerta = "style='color: green; font-size: 19px'" ; tempo = data.duracao;}
						if(data.duracao > 240 && data.duracao < 420){ alerta = "style='color: Chocolate; font-size: 19px'" ; tempo = data.duracao;}
						if(data.duracao > 420){  alerta = "style='color: red; font-size: 19px'" ; tempo = data.duracao;}
					}else {tempo = " " ; alerta = " "}
					
						$('#linha' + data.id).remove();
						$('#exampleModal').modal('hide');
						alert("atualizado com sucesso");
						
						if(data.status == "ABERTO"){ status = "class='table-danger'" }
						if(data.status == "AGENDADO"){ status = "class='table-warning'"; dataAgendado = data.dataAgendado; }
						if(data.status == "ANDAMENTO"){ status = "class='table-info'" }
						if(data.status == "AGUARDANDO"){ status = "class='table-secondary'" }
						if(data.status == "PAUSADO"){ status = "class='table-light'" }
						if(data.status == "FINALIZADO"){ status = "class='table-success'" }
						var itens =
						'<tr '+ status + ' id=linha' + data.id + ' data-bs-toggle="modal" '+ modal + data.id + ')>'
						+ '<td id=name' + data.id + '>' + data.id + '</td>'
						+ '<td>' + data.dataAbertura + '</td>'
						+ '<td>' + data.nomeCliente + '</td>'
						+ '<td>' + data.solicitante + '</td>'
						+ '<td>' + data.afetado + '</td>'
						+ '<td style="font-size: 12px;"><p> Local: ' + data.local + '</p><p> Categoria: ' + data.categoria +'</p>' + '</td>'
						+ '<td>' + data.descricao + '</td>'
						+ '<td>' + data.prioridade + '</td>'
						+ '<td>' + data.classificacao + '</td>'
						+ '<td>' + data.nomeFuncionario + '</td>'
						+ '<td>' + data.status + '</td>'
						+ '<td '+ alerta +'><b>' + data.duracao + '</b></td>'
						+ '<td>' + data.versao + '</td>'
						+ '</tr>'
						$('#linha' + data.id).remove();
						$('#tabela-solicitacoes').append(itens);
						$('#edicaoModalNaoFinalizado').modal('hide');
						preencheBotoesTabela();
				},
				statusCode: {
				    500: function() { alert('Erro! Contate o desenvolvedor!'); },
				    401: function() { alert('Realize login novamente!'); }
				}
			});
		}
		function excluir() {
			var id, modal; 
			if($('#idModalNaoFinalizado').text() != ' '){
				id = $('#idModalNaoFinalizado').text();
				modal ="#edicaoModalNaoFinalizado"
			}else{
				id = $('#idModalEdicaoModalEdicao').text();
				modal = "#edicaoModal";
			}
			
			if (confirm("Tem certeza que deseja excluir a solicitação de ID: " + id + " ?") == true) {
				var t = "#linha" + id;
				var remove = $(t).closest('tr');
				$.ajax({
					type: "DELETE",
					contentType: "application/json",
					url: "/sistech/solicitacao/excluir/" + id,
					success: function () {
						remove.fadeOut(800, function () {
							remove.remove();
						});
						$('#idModalNaoFinalizado').text(' ');
						$('#idModalEdicaoModalEdicao').text(' ');
						$(modal).modal('hide');
						preencheBotoesTabela();
					},
					error: function (e) { alert("Erro: Não foi possivel excluir a solicitação!"); }
				});
			}
		}
		
		function notificarCliente() {
			if (confirm("Tem certeza que deseja enviar o email de notificação ?") == true) {
				
				var id;
				var idFinalizado= $('#idModalEdicaoModalEdicao').text();
				var idNaoFinalizado= $('#idModalNaoFinalizado').text();
				
				if(idFinalizado != " "){
					id = idFinalizado;
				}else{
					id = idNaoFinalizado;
				}
					$.ajax({
						type: "POST",
						contentType: "application/json",
						url: "/sistech/solicitacao/notificar/" + id,
						success: function (data) {
							alert(data);
	
							$(modal).modal('hide');
						},
						error: function (e) { alert("Erro: Não foi possivel excluir a solicitação!"); }
					});
			}
		}
		
		var divStatus = $("#statusModalNaoFinalizado");
		var status = $("#statusModalNaoFinalizado").val();
		divStatus.on("change", function(){
			var status = $("#statusModalNaoFinalizado").val();
			if(status === 'AGENDADO'){
				$("#agendamentosmodal").stop().slideToggle(1000);
			}else {
				document.getElementById('agendamentosmodal').style.display = 'none';
			}
		});
		
		
		$(document).ready(function () {
			var divSolicitante = $("#nomeSolicitanteModalNaoFinalizado");
			divSolicitante.on("change", function () {
				var nomeColaborador = divSolicitante.val();
				var id_cliente = $('#id_cliente').text();
				$.ajax({
					type: "GET",
					contentType: "application/json",
					url: "/sistech/colaborador/list/cliente/"+ id_cliente +"/"+ nomeColaborador,
					success: function (data) {
						$('#celSolicitante').text(" ");
						if(data != null){
							$('#celSolicitante').text(data);
						}
					},
					statusCode: {
					    500: function() { alert('Erro! Contate o desenvolvedor!'); },
					    401: function() { alert('Realize login novamente!'); }
					}
				});
			});
		});
		
		$(document).ready(function () {
			var divAfetado = $("#nomeAfetadoModalNaoFinalizado");
			divAfetado.on("change", function () {
				var nomeColaborador = divAfetado.val();
				var id_cliente = $('#id_cliente').text();
				$.ajax({
					type: "GET",
					contentType: "application/json",
					url: "/sistech/colaborador/list/cliente/"+ id_cliente +"/"+ nomeColaborador,
					success: function (data) {
						$('#celAfetado').text(" ");
						if(data != null){
							$('#celAfetado').text(data);
						}
					},
					statusCode: {
					    500: function() { alert('Erro! Contate o desenvolvedor!'); },
					    401: function() { alert('Realize login novamente!'); }
					}
				});
			});
		});
	</script>
	<script>
		$(document).ready(function() {
		  $(".search").keyup(function () {
		    var searchTerm = $(".search").val();
		    var listItem = $('.results tbody').children('tr');
		    var searchSplit = searchTerm.replace(/ /g, "'):containsi('")
		    
		  $.extend($.expr[':'], {'containsi': function(elem, i, match, array){
		        return (elem.textContent || elem.innerText || '').toLowerCase().indexOf((match[3] || "").toLowerCase()) >= 0;
		    }
		  });
		    
		  $(".results tbody tr").not(":containsi('" + searchSplit + "')").each(function(e){
		    $(this).attr('visible','false');
		  });
		
		  $(".results tbody tr:containsi('" + searchSplit + "')").each(function(e){
		    $(this).attr('visible','true');
		  });
		
		  var jobCount = $('.results tbody tr[visible="true"]').length;
		    $('.counter').text(jobCount + ' item');
		
		  if(jobCount == '0') {$('.no-result').show();}
		    else {$('.no-result').hide();}
				  });
		});
	</script>
</body>
</html>